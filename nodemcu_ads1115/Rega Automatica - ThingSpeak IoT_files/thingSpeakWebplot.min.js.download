function vegaFactory(a,b){function c(a){return a.replace(G,"$1\\'")}function d(a,b,c,d){for(;d>c;){var e=c+d>>>1;E.cmp(a[e],b)<0?c=e+1:d=e}return c}function e(a,b,c){var d=0,e=a.split(H);return a=c?(e=e.reverse()).filter(function(a){return d+=a.length,b>=d}).reverse():e.filter(function(a){return d+=a.length,b>=d}),a.length?a.join("").trim():e[0].slice(0,b)}function f(a){E.config.isNode?process.stderr.write(a+"\n"):console.log(a)}function g(a){E.config.isNode?process.stderr.write(a+"\n"):console.error(a)}function h(a){return a.__vgtree__=!0,a.nodes=function(){return j(this,[])},a}function j(a,b){var c,d=a.values,e=d?d.length:0;for(b.push(a),c=0;e>c;++c)j(d[c],b);return b}function k(a){var b,c,d=a;if(E.isArray(a))for(d=[],b=0,c=a.length;c>b;++b)d.push(k(a[b]));else if(E.isObject(a)){d={};for(b in a)d[b]=k(a[b])}return d}function l(a,b,c){if(d=[],c&&b.length>1){for(var d,e,f,g=m(a.domain()),h=-1,i=b.length,j=(b[1]-b[0])/++c;++h<i;)for(e=c;--e>0;)(f=+b[h]-e*j)>=g[0]&&d.push(f);for(--h,e=0;++e<c&&(f=+b[h]+e*j)<g[1];)d.push(f)}return d}function m(a){var b=a[0],c=a[a.length-1];return c>b?[b,c]:[c,b]}function n(a){return a.rangeExtent?a.rangeExtent():m(a.range())}function o(a,b,c,d,e,f){e=Math.max(e,0)+f,("left"===a||"top"===a)&&(e*=-1),"top"===a||"bottom"===a?(E.extend(b.properties.enter,{x:c,y:{value:e}}),E.extend(b.properties.update,{x:d,y:{value:e},align:{value:"center"},baseline:{value:X[a]}})):(E.extend(b.properties.enter,{x:{value:e},y:c}),E.extend(b.properties.update,{x:{value:e},y:d,align:{value:W[a]},baseline:{value:"middle"}}))}function p(a,b,c,d,e){var f="left"===a||"top"===a?-1:1;e=e===1/0?"top"===a||"bottom"===a?{group:"mark.group.height",mult:-f}:{group:"mark.group.width",mult:-f}:{value:f*e},"top"===a||"bottom"===a?(E.extend(b.properties.enter,{x:c,y:{value:0},y2:e}),E.extend(b.properties.update,{x:d,y:{value:0},y2:e}),E.extend(b.properties.exit,{x:d})):(E.extend(b.properties.enter,{x:{value:0},x2:e,y:c}),E.extend(b.properties.update,{x:{value:0},x2:e,y:d}),E.extend(b.properties.exit,{y:d}))}function q(a,b,c,d){var e=~~((c[0]+c[1])/2),f="top"===a||"left"===a?-1:1;"bottom"===a||"top"===a?E.extend(b.properties.update,{x:{value:e},y:{value:f*d},angle:{value:0}}):E.extend(b.properties.update,{x:{value:f*d},y:{value:e},angle:{value:-90}})}function r(a,b,c,d){var e;("top"===a||"left"===a)&&(d=-1*d),e="bottom"===a||"top"===a?"M"+c[0]+","+d+"V0H"+c[1]+"V"+d:"M"+d+","+c[0]+"H0V"+c[1]+"H"+d,b.properties.update.path={value:e}}function s(a,b,c){var d=c?{}:a,e=a.mark.def.offset,f=a.mark.def.orient,g=b.width,h=b.height;if(E.isArray(e)){var i=e[0],j=e[1];switch(f){case"left":d.x=-i,d.y=j;break;case"right":d.x=g+i,d.y=j;break;case"bottom":d.x=i,d.y=h+j;break;case"top":d.x=i,d.y=-j;break;default:d.x=i,d.y=j}}else switch(E.isObject(e)&&(e=-b.scales[e.scale](e.value)),f){case"left":d.x=-e,d.y=0;break;case"right":d.x=g+e,d.y=0;break;case"bottom":d.x=0,d.y=h+e;break;case"top":d.x=0,d.y=-e;break;default:d.x=0,d.y=0}c&&c.interpolate(a,d)}function t(){return{type:"rule",interactive:!1,key:"data",properties:{enter:{stroke:{value:E.config.axis.tickColor},strokeWidth:{value:E.config.axis.tickWidth},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{opacity:{value:1}}}}}function u(){return{type:"text",interactive:!0,key:"data",properties:{enter:{fill:{value:E.config.axis.tickLabelColor},font:{value:E.config.axis.tickLabelFont},fontSize:{value:E.config.axis.tickLabelFontSize},opacity:{value:1e-6},text:{field:"label"}},exit:{opacity:{value:1e-6}},update:{opacity:{value:1}}}}}function v(){return{type:"text",interactive:!0,properties:{enter:{font:{value:E.config.axis.titleFont},fontSize:{value:E.config.axis.titleFontSize},fontWeight:{value:E.config.axis.titleFontWeight},fill:{value:E.config.axis.titleColor},align:{value:"center"},baseline:{value:"middle"},text:{field:"data"}},update:{}}}}function w(){return{type:"path",interactive:!1,properties:{enter:{x:{value:.5},y:{value:.5},stroke:{value:E.config.axis.axisColor},strokeWidth:{value:E.config.axis.axisWidth}},update:{}}}}function x(a,b,c){var d,e=c?{}:a,f=a.mark.def.offset,g=a.mark.def.orient,h=2*a.mark.def.padding,i=~~a.bounds.width()+(a.width?0:h),j=~~a.bounds.height()+(a.height?0:h);switch(e.x=.5,e.y=.5,e.width=i,e.height=j,!c&&b.bounds&&(b.bounds.delta=b.bounds.x2-b.width),g){case"left":d=b.bounds?b.bounds.x1:0,e.x+=d-f-i;break;case"right":d=b.width,b.bounds&&(d=c?b.width+b.bounds.delta:b.bounds.x2),e.x+=d+f}c&&c.interpolate(a,e),a.mark.def.properties.enter(a,b,c)}function y(a,b,c,d,e){var f=a.properties.enter,g=a.properties.update;b&&(f.size=g.size={scale:b.scaleName,field:"data"}),c&&(f.shape=g.shape={scale:c.scaleName,field:"data"}),d&&(f.fill=g.fill={scale:d.scaleName,field:"data"}),e&&(f.stroke=g.stroke={scale:e.scaleName,field:"data"})}function z(){var a=E.config.legend;return{type:"text",interactive:!1,key:"data",properties:{enter:{x:{value:0},y:{value:0},fill:{value:a.titleColor},font:{value:a.titleFont},fontSize:{value:a.titleFontSize},fontWeight:{value:a.titleFontWeight},baseline:{value:"top"},text:{field:"data"},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{opacity:{value:1}}}}}function A(){var a=E.config.legend;return{type:"symbol",interactive:!1,key:"data",properties:{enter:{x:{field:"offset",mult:.5},y:{scale:"legend",field:"index"},shape:{value:a.symbolShape},size:{value:a.symbolSize},stroke:{value:a.symbolColor},strokeWidth:{value:a.symbolStrokeWidth},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{x:{field:"offset",mult:.5},y:{scale:"legend",field:"index"},opacity:{value:1}}}}}function B(){var a=E.config.legend;return{type:"text",interactive:!1,key:"data",properties:{enter:{x:{field:"offset",offset:5},y:{scale:"legend",field:"index"},fill:{value:a.labelColor},font:{value:a.labelFont},fontSize:{value:a.labelFontSize},align:{value:a.labelAlign},baseline:{value:a.labelBaseline},text:{field:"label"},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{opacity:{value:1},x:{field:"offset",offset:5},y:{scale:"legend",field:"index"}}}}}function C(){var a=E.config.legend;return{type:"rect",interactive:!1,properties:{enter:{x:{value:0},y:{value:0},width:{value:a.gradientWidth},height:{value:a.gradientHeight},stroke:{value:a.gradientStrokeColor},strokeWidth:{value:a.gradientStrokeWidth},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{x:{value:0},y:{value:0},opacity:{value:1}}}}}function D(){var a=E.config.legend;return{type:"text",interactive:!1,key:"data",properties:{enter:{x:{scale:"legend",field:"data"},y:{value:20},dy:{value:2},fill:{value:a.labelColor},font:{value:a.labelFont},fontSize:{value:a.labelFontSize},align:{field:"align"},baseline:{value:"top"},text:{field:"label"},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{x:{scale:"legend",field:"data"},y:{value:20},opacity:{value:1}}}}}var E={version:"1.5.0",d3:a,topojson:b},F=Object.prototype.toString;E.isObject=function(a){return a===Object(a)},E.isFunction=function(a){return"[object Function]"==F.call(a)},E.isString=function(a){return"[object String]"==F.call(a)},E.isArray=Array.isArray||function(a){return"[object Array]"==F.call(a)},E.isNumber=function(a){return"[object Number]"==F.call(a)},E.isBoolean=function(a){return"[object Boolean]"==F.call(a)},E.isTree=function(a){return a&&a.__vgtree__},E.tree=function(a,b){var c=[a];return c.__vgtree__=!0,c.children=b||"children",c},E.number=function(a){return+a},E["boolean"]=function(a){return!!a},E.startsWith=String.prototype.startsWith?function(a,b){return a.startsWith(b)}:function(a,b){return 0===a.lastIndexOf(b,0)},E.identity=function(a){return a},E["true"]=function(){return!0},E.extend=function(a){for(var b,c,d=1,e=arguments.length;e>d;++d){b=arguments[d];for(c in b)a[c]=b[c]}return a},E.duplicate=function(a){return JSON.parse(JSON.stringify(a))},E.field=function(a){return a.split("\\.").map(function(a){return a.split(".")}).reduce(function(a,b){return a.length&&(a[a.length-1]+="."+b.shift()),a.push.apply(a,b),a},[])},E.accessor=function(a){var b;return E.isFunction(a)||null==a?a:E.isString(a)&&(b=E.field(a)).length>1?function(a){return b.reduce(function(a,b){return a[b]},a)}:function(b){return b[a]}},E.mutator=function(a){var b;return E.isString(a)&&(b=E.field(a)).length>1?function(a,c){for(var d=0;d<b.length-1;++d)a=a[b[d]];a[b[d]]=c}:function(b,c){b[a]=c}},E.comparator=function(a){var b=[];return void 0===a&&(a=[]),a=E.array(a).map(function(a){var c=1;return"-"===a[0]?(c=-1,a=a.slice(1)):"+"===a[0]&&(c=1,a=a.slice(1)),b.push(c),E.accessor(a)}),function(c,d){var e,f,g,h,i;for(e=0,f=a.length;f>e;++e){if(g=a[e],h=g(c),i=g(d),i>h)return-1*b[e];if(h>i)return b[e]}return 0}},E.cmp=function(a,b){return b>a?-1:a>b?1:a>=b?0:null===a&&null===b?0:null===a?-1:null===b?1:NaN},E.numcmp=function(a,b){return a-b},E.array=function(a){return null!=a?E.isArray(a)?a:[a]:[]},E.values=function(a){return E.isObject(a)&&!E.isArray(a)&&a.values?a.values:a},E.str=function(a){return E.isArray(a)?"["+a.map(E.str)+"]":E.isObject(a)?JSON.stringify(a):E.isString(a)?"'"+c(a)+"'":a};var G=/(^|[^\\])'/g;E.keys=function(a){var b=[];for(var c in a)b.push(c);return b},E.toMap=function(a){return a.reduce(function(a,b){return a[b]=1,a},{})},E.unique=function(a,b,c){if(!E.isArray(a)||0===a.length)return[];b=b||E.identity,c=c||[];for(var d,e={},f=0,g=a.length;g>f;++f)d=b(a[f]),d in e||(e[d]=!0,c.push(d));return c},E.minIndex=function(a,b){if(!E.isArray(a)||0==a.length)return-1;b=b||E.identity;for(var c=0,d=b(a[0]),e=d,f=1,g=a.length;g>f;++f)e=b(a[f]),d>e&&(d=e,c=f);return c},E.maxIndex=function(a,b){if(!E.isArray(a)||0==a.length)return-1;b=b||E.identity;for(var c=0,d=b(a[0]),e=d,f=1,g=a.length;g>f;++f)e=b(a[f]),e>d&&(d=e,c=f);return c},E.bins=function(a){a=a||{};var b,c,e,f,g=a.maxbins||1024,h=a.base||10,i=a.div||[5,2],j=a.minstep||0,k=Math.log(h),l=Math.ceil(Math.log(g)/k),m=a.min,n=a.max,o=n-m,p=Math.max(j,Math.pow(h,Math.round(Math.log(o)/k)-l)),q=Math.ceil(o/p);if(null!=a.step)p=a.step;else if(a.steps)p=a.steps[Math.min(a.steps.length-1,d(a.steps,o/g,0,a.steps.length))];else{do p*=h,q=Math.ceil(o/p);while(q>g);for(e=0;e<i.length;++e)c=p/i[e],c>=j&&g>=o/c&&(p=c,q=Math.ceil(o/p))}return c=Math.log(p),b=c>=0?0:~~(-c/k)+1,f=(0>m?-1:1)*Math.pow(h,-b-1),m=Math.min(m,Math.floor(m/p+f)*p),n=Math.ceil(n/p)*p,{start:m,stop:n,step:p,unit:b}},E.truncate=function(a,b,c,d,f){var g=a.length;if(b>=g)return a;f=f||"...";var h=Math.max(0,b-f.length);switch(c){case"left":return f+(d?e(a,h,1):a.slice(g-h));case"middle":case"center":var i=Math.ceil(h/2),j=Math.floor(h/2);return(d?e(a,i):a.slice(0,i))+f+(d?e(a,j,1):a.slice(g-j));default:return(d?e(a,h):a.slice(0,h))+f}};var H=/([\u0009\u000A\u000B\u000C\u000D\u0020\u00A0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u2028\u2029\u3000\uFEFF])/;E.log=function(a){f("[Vega Log] "+a)},E.error=function(a){g("[Vega Err] "+a)},E.config={},E.config.isNode=!1,E.config.domainWhiteList=!1,E.config.safeMode=!1,E.config.baseURL="",E.config.defaultProtocol="http:",E.config.svgNamespace='version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"',E.config.autopadInset=5,E.config.scale={time:a.time.scale,utc:a.time.scale.utc},E.config.render={lineWidth:1,lineCap:"butt",font:"sans-serif",fontSize:11},E.config.axis={orient:"bottom",ticks:10,padding:3,axisColor:"#000",gridColor:"#d8d8d8",tickColor:"#000",tickLabelColor:"#000",axisWidth:1,tickWidth:1,tickSize:6,tickLabelFontSize:11,tickLabelFont:"sans-serif",titleColor:"#000",titleFont:"sans-serif",titleFontSize:11,titleFontWeight:"bold",titleOffset:35},E.config.legend={orient:"right",offset:10,padding:3,gradientStrokeColor:"#888",gradientStrokeWidth:1,gradientHeight:16,gradientWidth:100,labelColor:"#000",labelFontSize:10,labelFont:"sans-serif",labelAlign:"left",labelBaseline:"middle",labelOffset:8,symbolShape:"circle",symbolSize:50,symbolColor:"#888",symbolStrokeWidth:1,titleColor:"#000",titleFont:"sans-serif",titleFontSize:11,titleFontWeight:"bold"},E.config.color={rgb:[128,128,128],lab:[50,0,0],hcl:[0,0,50],hsl:[0,0,.5]},E.config.range={category10:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],category20:["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],shapes:["circle","cross","diamond","square","triangle-down","triangle-up"]},E.Bounds=function(){var a=function(a){this.clear(),a&&this.union(a)},b=a.prototype;return b.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},b.set=function(a,b,c,d){return this.x1=a,this.y1=b,this.x2=c,this.y2=d,this},b.add=function(a,b){return a<this.x1&&(this.x1=a),b<this.y1&&(this.y1=b),a>this.x2&&(this.x2=a),b>this.y2&&(this.y2=b),this},b.expand=function(a){return this.x1-=a,this.y1-=a,this.x2+=a,this.y2+=a,this},b.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},b.translate=function(a,b){return this.x1+=a,this.x2+=a,this.y1+=b,this.y2+=b,this},b.rotate=function(a,b,c){var d=Math.cos(a),e=Math.sin(a),f=b-b*d+c*e,g=c-b*e-c*d,h=this.x1,i=this.x2,j=this.y1,k=this.y2;return this.clear().add(d*h-e*j+f,e*h+d*j+g).add(d*h-e*k+f,e*h+d*k+g).add(d*i-e*j+f,e*i+d*j+g).add(d*i-e*k+f,e*i+d*k+g)},b.union=function(a){return a.x1<this.x1&&(this.x1=a.x1),a.y1<this.y1&&(this.y1=a.y1),a.x2>this.x2&&(this.x2=a.x2),a.y2>this.y2&&(this.y2=a.y2),this},b.encloses=function(a){return a&&this.x1<=a.x1&&this.x2>=a.x2&&this.y1<=a.y1&&this.y2>=a.y2},b.intersects=function(a){return a&&!(this.x2<a.x1||this.x1>a.x2||this.y2<a.y1||this.y1>a.y2)},b.contains=function(a,b){return!(a<this.x1||a>this.x2||b<this.y1||b>this.y2)},b.width=function(){return this.x2-this.x1},b.height=function(){return this.y2-this.y1},a}(),E.Gradient=function(){function a(a){this.id="grad_"+I++,this.type=a||"linear",this.stops=[],this.x1=0,this.x2=1,this.y1=0,this.y2=0}var b=a.prototype;return b.stop=function(a,b){return this.stops.push({offset:a,color:b}),this},a}();var I=0;E.canvas={},E.canvas.path=function(){function b(a){var b,c,d,e=[];a=a.slice().replace(m[0],"###$1").split(m[1]).slice(1);for(var f,g,h=0,i=a.length;i>h;h++){b=a[h],c=b.slice(1).trim().replace(m[2],"$1###-").split(m[3]),g=[b.charAt(0)];for(var f=0,j=c.length;j>f;f++)d=parseFloat(c[f]),isNaN(d)||g.push(d);var k=g[0].toLowerCase(),n=l[k];if(g.length-1>n)for(var o=1,p=g.length;p>o;o+=n)e.push([g[0]].concat(g.slice(o,o+n)));else e.push(g)}return e}function c(a,b,c,d,g,h,i){for(var j=d[0],k=d[1],l=d[2],m=d[3],n=d[4],o=d[5],p=d[6],q=e(o,p,j,k,m,n,l,b,c),r=0;r<q.length;r++){var s=f.apply(null,q[r]);a.bezierCurveTo.apply(a,s),g.add(s[0]-h,s[1]-i),g.add(s[2]-h,s[3]-i),g.add(s[4]-h,s[5]-i)}}function d(a,b,c,d){for(var g=c[0],h=c[1],i=c[2],j=c[3],k=c[4],l=c[5],m=c[6],n=e(l,m,g,h,j,k,i,a,b),o=0;o<n.length;o++){var p=f.apply(null,n[o]);d.add(p[0],p[1]),d.add(p[2],p[3]),d.add(p[4],p[5])}}function e(a,b,c,d,e,f,g,h,i){if(k=p.call(arguments),n[k])return n[k];var j=g*(Math.PI/180),l=Math.sin(j),m=Math.cos(j);c=Math.abs(c),d=Math.abs(d);var o=m*(h-a)*.5+l*(i-b)*.5,q=m*(i-b)*.5-l*(h-a)*.5,r=o*o/(c*c)+q*q/(d*d);r>1&&(r=Math.sqrt(r),c*=r,d*=r);var s=m/c,t=l/c,u=-l/d,v=m/d,w=s*h+t*i,x=u*h+v*i,y=s*a+t*b,z=u*a+v*b,A=(y-w)*(y-w)+(z-x)*(z-x),B=1/A-.25;0>B&&(B=0);var C=Math.sqrt(B);f==e&&(C=-C);var D=.5*(w+y)-C*(z-x),E=.5*(x+z)+C*(y-w),F=Math.atan2(x-E,w-D),G=Math.atan2(z-E,y-D),H=G-F;0>H&&1==f?H+=2*Math.PI:H>0&&0==f&&(H-=2*Math.PI);for(var I=Math.ceil(Math.abs(H/(.5*Math.PI+.001))),J=[],K=0;I>K;K++){var L=F+K*H/I,M=F+(K+1)*H/I;J[K]=[D,E,L,M,c,d,l,m]}return n[k]=J}function f(a,b,c,d,e,f,g,h){if(k=p.call(arguments),o[k])return o[k];var i=h*e,j=-g*f,l=g*e,m=h*f,n=Math.cos(c),q=Math.sin(c),r=Math.cos(d),s=Math.sin(d),t=.5*(d-c),u=Math.sin(.5*t),v=8/3*u*u/Math.sin(t),w=a+n-v*q,x=b+q+v*n,y=a+r,z=b+s,A=y+v*s,B=z-v*r;return o[k]=[i*w+j*x,l*w+m*x,i*A+j*B,l*A+m*B,i*y+j*z,l*y+m*z]}function g(a,b,d,e){var f,g,h,i,j,k=null,l=0,m=0,n=0,o=0,p=new E.Bounds;void 0==d&&(d=0),void 0==e&&(e=0),a.beginPath();for(var q=0,r=b.length;r>q;++q){switch(f=b[q],f[0]){case"l":l+=f[1],m+=f[2],a.lineTo(l+d,m+e),p.add(l,m);break;case"L":l=f[1],m=f[2],a.lineTo(l+d,m+e),p.add(l,m);break;case"h":l+=f[1],a.lineTo(l+d,m+e),p.add(l,m);break;case"H":l=f[1],a.lineTo(l+d,m+e),p.add(l,m);break;case"v":m+=f[1],a.lineTo(l+d,m+e),p.add(l,m);break;case"V":m=f[1],a.lineTo(l+d,m+e),p.add(l,m);break;case"m":l+=f[1],m+=f[2],a.moveTo(l+d,m+e),p.add(l,m);break;case"M":l=f[1],m=f[2],a.moveTo(l+d,m+e),p.add(l,m);break;case"c":g=l+f[5],h=m+f[6],n=l+f[3],o=m+f[4],a.bezierCurveTo(l+f[1]+d,m+f[2]+e,n+d,o+e,g+d,h+e),p.add(l+f[1],m+f[2]),p.add(n,o),p.add(g,h),l=g,m=h;break;case"C":l=f[5],m=f[6],n=f[3],o=f[4],a.bezierCurveTo(f[1]+d,f[2]+e,n+d,o+e,l+d,m+e),p.add(f[1],f[2]),p.add(n,o),p.add(l,m);break;case"s":g=l+f[3],h=m+f[4],n=2*l-n,o=2*m-o,a.bezierCurveTo(n+d,o+e,l+f[1]+d,m+f[2]+e,g+d,h+e),p.add(n,o),p.add(l+f[1],m+f[2]),p.add(g,h),n=l+f[1],o=m+f[2],l=g,m=h;break;case"S":g=f[3],h=f[4],n=2*l-n,o=2*m-o,a.bezierCurveTo(n+d,o+e,f[1]+d,f[2]+e,g+d,h+e),l=g,m=h,p.add(f[1],f[2]),p.add(n,o),p.add(g,h),n=f[1],o=f[2];break;case"q":g=l+f[3],h=m+f[4],n=l+f[1],o=m+f[2],a.quadraticCurveTo(n+d,o+e,g+d,h+e),l=g,m=h,p.add(n,o),p.add(g,h);break;case"Q":g=f[3],h=f[4],a.quadraticCurveTo(f[1]+d,f[2]+e,g+d,h+e),l=g,m=h,n=f[1],o=f[2],p.add(n,o),p.add(g,h);break;case"t":g=l+f[1],h=m+f[2],null===k[0].match(/[QqTt]/)?(n=l,o=m):"t"===k[0]?(n=2*l-i,o=2*m-j):"q"===k[0]&&(n=2*l-n,o=2*m-o),i=n,j=o,a.quadraticCurveTo(n+d,o+e,g+d,h+e),l=g,m=h,n=l+f[1],o=m+f[2],p.add(n,o),p.add(g,h);break;case"T":g=f[1],h=f[2],n=2*l-n,o=2*m-o,a.quadraticCurveTo(n+d,o+e,g+d,h+e),l=g,m=h,p.add(n,o),p.add(g,h);break;case"a":c(a,l+d,m+e,[f[1],f[2],f[3],f[4],f[5],f[6]+l+d,f[7]+m+e],p,d,e),l+=f[6],m+=f[7];break;case"A":c(a,l+d,m+e,[f[1],f[2],f[3],f[4],f[5],f[6]+d,f[7]+e],p,d,e),l=f[6],m=f[7];break;case"z":case"Z":a.closePath()}k=f}return p.translate(d,e)}function h(a,b){for(var c,e,f,g,h,i=null,j=0,k=0,l=0,m=0,n=0,o=a.length;o>n;++n){switch(c=a[n],c[0]){case"l":j+=c[1],k+=c[2],b.add(j,k);break;case"L":j=c[1],k=c[2],b.add(j,k);break;case"h":j+=c[1],b.add(j,k);break;case"H":j=c[1],b.add(j,k);break;case"v":k+=c[1],b.add(j,k);break;case"V":k=c[1],b.add(j,k);break;case"m":j+=c[1],k+=c[2],b.add(j,k);break;case"M":j=c[1],k=c[2],b.add(j,k);break;case"c":e=j+c[5],f=k+c[6],l=j+c[3],m=k+c[4],b.add(j+c[1],k+c[2]),b.add(l,m),b.add(e,f),j=e,k=f;break;case"C":j=c[5],k=c[6],l=c[3],m=c[4],b.add(c[1],c[2]),b.add(l,m),b.add(j,k);break;case"s":e=j+c[3],f=k+c[4],l=2*j-l,m=2*k-m,b.add(l,m),b.add(j+c[1],k+c[2]),b.add(e,f),l=j+c[1],m=k+c[2],j=e,k=f;break;case"S":e=c[3],f=c[4],l=2*j-l,m=2*k-m,j=e,k=f,b.add(c[1],c[2]),b.add(l,m),b.add(e,f),l=c[1],m=c[2];break;case"q":e=j+c[3],f=k+c[4],l=j+c[1],m=k+c[2],j=e,k=f,b.add(l,m),b.add(e,f);break;case"Q":e=c[3],f=c[4],j=e,k=f,l=c[1],m=c[2],b.add(l,m),b.add(e,f);break;case"t":e=j+c[1],f=k+c[2],null===i[0].match(/[QqTt]/)?(l=j,m=k):"t"===i[0]?(l=2*j-g,m=2*k-h):"q"===i[0]&&(l=2*j-l,m=2*k-m),g=l,h=m,j=e,k=f,l=j+c[1],m=k+c[2],b.add(l,m),b.add(e,f);break;case"T":e=c[1],f=c[2],l=2*j-l,m=2*k-m,j=e,k=f,b.add(l,m),b.add(e,f);break;case"a":d(j,k,[c[1],c[2],c[3],c[4],c[5],c[6]+j,c[7]+k],b),j+=c[6],k+=c[7];break;case"A":d(j,k,[c[1],c[2],c[3],c[4],c[5],c[6],c[7]],b),j=c[6],k=c[7];break;case"z":case"Z":}i=c}return b}function i(b){var c,d=b[0];return c="horizontal"===d.orient?a.svg.area().y(function(a){return a.y}).x0(function(a){return a.x}).x1(function(a){return a.x+a.width}):a.svg.area().x(function(a){return a.x}).y1(function(a){return a.y}).y0(function(a){return a.y+a.height}),d.interpolate&&c.interpolate(d.interpolate),null!=d.tension&&c.tension(d.tension),c(b)}function j(b){var c=b[0],d=a.svg.line().x(function(a){return a.x}).y(function(a){return a.y});return c.interpolate&&d.interpolate(c.interpolate),null!=c.tension&&d.tension(c.tension),d(b)}var k,l={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},m=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)-/g,/\s|,|###/],n={},o={},p=Array.prototype.join;return{parse:b,render:g,bounds:h,area:i,line:j}}(),E.canvas.marks=function(){function a(a,b){var c=b.x||0,d=b.y||0,e=b.innerRadius||0,f=b.outerRadius||0,g=(b.startAngle||0)-Math.PI/2,h=(b.endAngle||0)-Math.PI/2;a.beginPath(),0===e?a.moveTo(c,d):a.arc(c,d,e,g,h,0),a.arc(c,d,f,h,g,1),a.closePath()}function b(a,b){var c=b[0],d=c.mark,e=d.pathCache||(d.pathCache=y(E.canvas.path.area(b)));z(a,e)}function c(a,b){var c=b[0],d=c.mark,e=d.pathCache||(d.pathCache=y(E.canvas.path.line(b)));z(a,e)}function d(a,b){if(null!=b.path){var c=b.pathCache||(b.pathCache=y(b.path));return z(a,c,b.x,b.y)}}function e(a,b){a.beginPath();var c,d,e,f,g=null!=b.size?b.size:100,h=b.x,i=b.y;if(null==b.shape||"circle"===b.shape)return c=Math.sqrt(g/Math.PI),a.arc(h,i,c,0,2*Math.PI,0),void a.closePath();switch(b.shape){case"cross":c=Math.sqrt(g/5)/2,d=3*c,a.moveTo(h-d,i-c),a.lineTo(h-c,i-c),a.lineTo(h-c,i-d),a.lineTo(h+c,i-d),a.lineTo(h+c,i-c),a.lineTo(h+d,i-c),a.lineTo(h+d,i+c),a.lineTo(h+c,i+c),a.lineTo(h+c,i+d),a.lineTo(h-c,i+d),a.lineTo(h-c,i+c),a.lineTo(h-d,i+c);break;case"diamond":f=Math.sqrt(g/(2*B)),e=f*B,a.moveTo(h,i-f),a.lineTo(h+e,i),a.lineTo(h,i+f),a.lineTo(h-e,i);break;case"square":d=Math.sqrt(g),c=d/2,a.rect(h-c,i-c,d,d);break;case"triangle-down":e=Math.sqrt(g/A),f=e*A/2,a.moveTo(h,i+f),a.lineTo(h+e,i-f),a.lineTo(h-e,i-f);break;case"triangle-up":e=Math.sqrt(g/A),f=e*A/2,a.moveTo(h,i-f),a.lineTo(h+e,i+f),a.lineTo(h-e,i+f)}a.closePath()}function f(a,b){var d=b[0],e=d.strokeWidth,f=d.strokeCap;a.lineWidth=null!=e?e:E.config.render.lineWidth,a.lineCap=null!=f?f:E.config.render.lineCap,c(a,b)}function g(a,b){var c=b.x||0,d=b.y||0,e=null!=b.x2?b.x2:c,f=null!=b.y2?b.y2:d,g=b.strokeWidth,h=b.strokeCap;a.lineWidth=null!=g?g:E.config.render.lineWidth,a.lineCap=null!=h?h:E.config.render.lineCap,a.beginPath(),a.moveTo(c,d),a.lineTo(e,f)}function h(a,b,c,d){var e,f,g,h=c.fill,i=c.stroke;a(b,d),e=null==c.opacity?1:c.opacity,0!=e&&(h||i)&&(h&&(b.globalAlpha=e*(null==c.fillOpacity?1:c.fillOpacity),b.fillStyle=q(b,c,h),b.fill()),i&&(g=null!=(g=c.strokeWidth)?g:E.config.render.lineWidth,g>0&&(b.globalAlpha=e*(null==c.strokeOpacity?1:c.strokeOpacity),b.strokeStyle=q(b,c,i),b.lineWidth=g,b.lineCap=null!=(f=c.strokeCap)?f:E.config.render.lineCap,b.vgLineDash(c.strokeDash||null),b.vgLineDashOffset(c.strokeDashOffset||0),b.stroke())))}function i(a,b,c,d){var e,f,g;for(e=0,f=c.items.length;f>e;++e)g=c.items[e],(!d||d.intersects(g.bounds))&&h(a,b,g,g)}function j(a,b,c){if(b.items.length)for(var d,e,f,g,h,i,j,k,l,m,n=b.items,o=0,p=n.length;p>o;++o)d=n[o],(!c||c.intersects(d.bounds))&&(j=d.x||0,k=d.y||0,l=d.width||0,m=d.height||0,g=null==d.opacity?1:d.opacity,0!=g&&((e=d.fill)&&(a.globalAlpha=g*(null==d.fillOpacity?1:d.fillOpacity),a.fillStyle=q(a,d,e),a.fillRect(j,k,l,m)),(f=d.stroke)&&(i=null!=(i=d.strokeWidth)?i:E.config.render.lineWidth,i>0&&(a.globalAlpha=g*(null==d.strokeOpacity?1:d.strokeOpacity),a.strokeStyle=q(a,d,f),a.lineWidth=i,a.lineCap=null!=(h=d.strokeCap)?h:E.config.render.lineCap,a.vgLineDash(d.strokeDash||null),a.vgLineDashOffset(d.strokeDashOffset||0),a.strokeRect(j,k,l,m)))))}function k(a,b,c){if(b.items.length)for(var d,e,f,g,h,i,j,k,l,m=b.items,n=0,o=m.length;o>n;++n)d=m[n],(!c||c.intersects(d.bounds))&&(i=d.x||0,j=d.y||0,k=null!=d.x2?d.x2:i,l=null!=d.y2?d.y2:j,f=null==d.opacity?1:d.opacity,0!=f&&(e=d.stroke)&&(h=null!=(h=d.strokeWidth)?h:E.config.render.lineWidth,h>0&&(a.globalAlpha=f*(null==d.strokeOpacity?1:d.strokeOpacity),a.strokeStyle=q(a,d,e),a.lineWidth=h,a.lineCap=null!=(g=d.strokeCap)?g:E.config.render.lineCap,a.vgLineDash(d.strokeDash||null),a.vgLineDashOffset(d.strokeDashOffset||0),a.beginPath(),a.moveTo(i,j),a.lineTo(k,l),a.stroke())))}function l(a,b,c){if(b.items.length)for(var d,e=this,f=b.items,g=0,h=f.length;h>g;++g)if(d=f[g],!c||c.intersects(d.bounds)){d.image&&d.image.url===d.url||(d.image=e.loadImage(d.url),d.image.url=d.url);var i,j,k,l,m;k=d.width||d.image&&d.image.width||0,l=d.height||d.image&&d.image.height||0,i=(d.x||0)-("center"===d.align?k/2:"right"===d.align?k:0),j=(d.y||0)-("middle"===d.baseline?l/2:"bottom"===d.baseline?l:0),d.image.loaded&&(a.globalAlpha=null!=(m=d.opacity)?m:1,a.drawImage(d.image,i,j,k,l))}}function m(a,b,c){if(b.items.length)for(var d,e,f,g,h,i,j,k,l,m=b.items,n=0,o=m.length;o>n;++n)d=m[n],(!c||c.intersects(d.bounds))&&(a.font=E.scene.fontString(d),a.textAlign=d.align||"left",a.textBaseline=d.baseline||"alphabetic",g=null==d.opacity?1:d.opacity,0!=g&&(i=d.x||0,j=d.y||0,(k=d.radius)&&(l=(d.theta||0)-Math.PI/2,i+=k*Math.cos(l),j+=k*Math.sin(l)),d.angle?(a.save(),a.translate(i,j),a.rotate(d.angle*Math.PI/180),i=d.dx||0,j=d.dy||0):(i+=d.dx||0,j+=d.dy||0),(e=d.fill)&&(a.globalAlpha=g*(null==d.fillOpacity?1:d.fillOpacity),a.fillStyle=q(a,d,e),a.fillText(d.text,i,j)),(f=d.stroke)&&(h=null!=(h=d.strokeWidth)?h:1,h>0&&(a.globalAlpha=g*(null==d.strokeOpacity?1:d.strokeOpacity),a.strokeStyle=q(d,f),a.lineWidth=h,a.strokeText(d.text,i,j))),d.angle&&a.restore()))}function n(a){return function(b,c,d){i(a,b,c,d)}}function o(a){return function(b,c,d){c.items.length&&(!d||d.intersects(c.items[0].bounds))&&h(a,b,c.items[0],c.items)}}function p(a,b,c){if(b.items.length){var d,e,f,g,h,i,k,l,m,n=b.items,o=this;for(j(a,b,c),i=0,k=n.length;k>i;++i){for(d=n[i],e=d.axisItems||[],f=d.legendItems||[],g=d.x||0,h=d.y||0,a.save(),a.translate(g,h),d.clip&&(a.beginPath(),a.rect(0,0,d.width||0,d.height||0),a.clip()),c&&c.translate(-g,-h),l=0,m=e.length;m>l;++l)"back"===e[l].def.layer&&o.draw(a,e[l],c);for(l=0,m=d.items.length;m>l;++l)o.draw(a,d.items[l],c);for(l=0,m=e.length;m>l;++l)"back"!==e[l].def.layer&&o.draw(a,e[l],c);for(l=0,m=f.length;m>l;++l)o.draw(a,f[l],c);c&&c.translate(g,h),a.restore()}}}function q(a,b,c){return c.id?r(a,c,b.bounds):c}function r(a,b,c){var d,e,f=c.width(),g=c.height(),h=c.x1+b.x1*f,i=c.y1+b.y1*g,j=c.x1+b.x2*f,k=c.y1+b.y2*g,l=a.createLinearGradient(h,i,j,k),m=b.stops;for(d=0,e=m.length;e>d;++d)l.addColorStop(m[d].offset,m[d].color);return l}function s(a,b,c,d,e,f){if(0===b.items.length||b.bounds&&!b.bounds.contains(e,f))return!1;var g,h,i,j,k,l,m,n=b.items,o=this;for(l=n.length;--l>=0;){for(h=n[l],j=h.x||0,k=h.y||0,a.save(),a.translate(j,k),m=h.items.length;--m>=0;)if(g=h.items[m],g.interactive!==!1&&(i=o.pick(g,c,d,e-j,f-k)))return a.restore(),i;a.restore()}return b.interactive?t(D.group,a,b,c,d,e,f):!1}function t(a,b,c,d,e,f,g){if(!c.items.length)return!1;var h,i,j;for(1!==b._ratio&&(d*=b._ratio,e*=b._ratio),j=c.items.length;--j>=0;)if(h=c.items[j],i=h.bounds,(!i||i.contains(f,g))&&i&&a(b,h,d,e,f,g))return h;return!1}function u(a,b,c,d,e,f){if(!b.items.length)return!1;var g,h=b.items;return g=h[0].bounds,g&&!g.contains(e,f)?!1:(1!==a._ratio&&(c*=a._ratio,d*=a._ratio),D.area(a,h,c,d)?h[0]:!1)}function v(a,b,c,d,e,f){if(!b.items.length)return!1;var g,h=b.items;return g=h[0].bounds,g&&!g.contains(e,f)?!1:(1!==a._ratio&&(c*=a._ratio,d*=a._ratio),D.line(a,h,c,d)?h[0]:!1)}function w(a){return function(b,c,d,e,f,g){return t(a,b,c,d,e,f,g)}}function x(a,b,c,d,e,f){if(!b.fontSize)return!1;if(!b.angle)return!0;var g=E.scene.bounds.text(b,C,!0),h=-b.angle*Math.PI/180,i=Math.cos(h),j=Math.sin(h),c=b.x,d=b.y,k=i*e-j*f+(c-c*i+d*j),l=j*e+i*f+(d-c*j-d*i);return g.contains(k,l)}var y=E.canvas.path.parse,z=E.canvas.path.render,A=(Math.PI/2,Math.sqrt(3)),B=Math.tan(30*Math.PI/180),C=new E.Bounds,D={text:x,rect:function(a,b,c,d){return!0},image:function(a,b,c,d){return!0},group:function(a,b,c,d){return b.fill||b.stroke},rule:function(a,b,c,d){return a.isPointInStroke?(g(a,b),a.isPointInStroke(c,d)):!1},line:function(a,b,c,d){return a.isPointInStroke?(f(a,b),a.isPointInStroke(c,d)):!1},arc:function(b,c,d,e){return a(b,c),b.isPointInPath(d,e)},area:function(a,c,d,e){return b(a,c),a.isPointInPath(d,e)},path:function(a,b,c,e){return d(a,b),a.isPointInPath(c,e)},symbol:function(a,b,c,d){return e(a,b),a.isPointInPath(c,d)}};return{draw:{group:p,area:o(b),line:o(c),arc:n(a),path:n(d),symbol:n(e),rect:j,rule:k,text:m,image:l,drawOne:o,drawAll:n},pick:{group:s,area:u,line:v,arc:w(D.arc),path:w(D.path),symbol:w(D.symbol),rect:w(D.rect),rule:w(D.rule),text:w(D.text),image:w(D.image),pickAll:t}}}(),E.canvas.Renderer=function(){function b(a,b){var c=window.devicePixelRatio||1,d=b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1,e=c/d;if(c!==d){var f=a.width,g=a.height;a.setAttribute("width",f*e),a.setAttribute("height",g*e),a.style.width=f+"px",a.style.height=g+"px"}return e}function c(a){if(!a.vgLineDash){var b=[];a.setLineDash?(a.vgLineDash=function(a){this.setLineDash(a||b)},a.vgLineDashOffset=function(a){this.lineDashOffset=a}):void 0!==a.webkitLineDash?(a.vgLineDash=function(a){this.webkitLineDash=a||b},a.vgLineDashOffset=function(a){this.webkitLineDashOffset=a}):void 0!==a.mozDash?(a.vgLineDash=function(a){this.mozDash=a},a.vgLineDashOffset=function(a){}):(a.vgLineDash=function(a){},a.vgLineDashOffset=function(a){})}}function d(a,b){for(var c=new E.Bounds(b);null!=(a=a.mark.group);)c.translate(a.x||0,a.y||0);return c}function e(a){return a?E.array(a).reduce(function(a,b){return a.union(d(b,b.bounds)).union(d(b,b["bounds:prev"]))},new E.Bounds):null}function f(a,b){var c=null;return b&&(c=new E.Bounds(b).round(),a.beginPath(),a.rect(c.x1,c.y1,c.width(),c.height()),a.clip()),c}var g=function(){this._ctx=null,this._el=null,this._bgcolor=null,this._imgload=0},h=g.prototype;return h.initialize=function(b,c,d,e,f){if(this._el=b,this.background(f),!b)return this;var g=a.select(b).selectAll("canvas.marks").data([1]);return g.enter().append("canvas").attr("class","marks"),g.exit().remove(),this.resize(c,d,e)},h.background=function(a){return this._bgcolor=a,this},h.resize=function(d,e,f){if(this._width=d,this._height=e,this._padding=f,this._el){var g=a.select(this._el).select("canvas.marks");g.attr("width",d+f.left+f.right).attr("height",e+f.top+f.bottom);var h;this._ctx=g.node().getContext("2d"),this._ctx._ratio=h=b(g.node(),this._ctx)||1,this._ctx.setTransform(h,0,0,h,h*f.left,h*f.top)}return c(this._ctx),this},h.context=function(a){return a?(this._ctx=a,this):this._ctx},h.element=function(){return this._el},h.pendingImages=function(){return this._imgload},h.render=function(a,b){var c,d=this._ctx,g=this._padding,h=this._width+g.left+g.right,i=this._height+g.top+g.bottom,j=null;this._scene=a,d.save(),j=f(d,e(b)),this.clear(-g.left,-g.top,h,i),this.draw(d,a,j),b&&(d.restore(),d.save(),c=f(d,e(b)),j.encloses(c)||(this.clear(-g.left,-g.top,h,i),this.draw(d,a,c))),d.restore(),this._scene=null},h.draw=function(a,b,c){var d=b.marktype,e=E.canvas.marks.draw[d];e.call(this,a,b,c)},h.clear=function(a,b,c,d){var e=this._ctx;e.clearRect(a,b,c,d),null!=this._bgcolor&&(e.fillStyle=this._bgcolor,e.fillRect(a,b,c,d))},h.renderAsync=function(a){var b=this;b._async_id&&clearTimeout(b._async_id),b._async_id=setTimeout(function(){b.render(a),delete b._async_id},50)},h.loadImage=function(a){var b,c=this,d=c._scene,e=null;if(E.config.isNode)c._imgload+=1,e=new(require("canvas").Image),E.data.load(a,function(b,d){return c._imgload-=1,b?void E.error(b):(E.log("LOAD IMAGE: "+a),e.src=d,void(e.loaded=!0))});else{if(e=new Image,b=E.data.load.sanitizeUrl(a),!b)return;c._imgload+=1,e.onload=function(){E.log("LOAD IMAGE: "+b),e.loaded=!0,c._imgload-=1,c.renderAsync(d)},e.src=b}return e},g}(),E.canvas.Handler=function(){function b(a){var b=a.indexOf(".");return 0>b?a:a.slice(0,b)}var c=function(a,b){this._active=null,this._down=null,this._handlers={},a&&this.initialize(a),b&&this.model(b)},d=c.prototype;d.initialize=function(b,c,f){this._el=a.select(b).node(),this._canvas=a.select(b).select("canvas.marks").node(),this._padding=c,this._obj=f||null;var g=this._canvas,h=this;return e.forEach(function(a){g.addEventListener(a,function(b){d[a].call(h,b)})}),this},d.padding=function(a){
return this._padding=a,this},d.model=function(a){return arguments.length?(this._model=a,this):this._model},d.handlers=function(){var a=this._handlers;return E.keys(a).reduce(function(b,c){return a[c].reduce(function(a,b){return a.push(b),a},b)},[])};var e=["mouseup","dblclick","wheel","keydown","keypress","keyup","mousewheel"];return e.forEach(function(a){d[a]=function(b){this.fire(a,b)}}),e.push("mousedown"),e.push("mousemove"),e.push("mouseout"),e.push("click"),d.mousemove=function(a){var b=this._padding,c=a.target.getBoundingClientRect(),d=a.clientX-c.left,e=a.clientY-c.top,f=this._active,g=this.pick(this._model.scene(),d,e,d-b.left,e-b.top);return g===f?void this.fire("mousemove",a):(f&&this.fire("mouseout",a),this._active=g,void(g&&this.fire("mouseover",a)))},d.mouseout=function(a){this._active&&this.fire("mouseout",a),this._active=null},d.mousedown=function(a){this._down=this._active,this.fire("mousedown",a)},d.click=function(a){this._down===this._active&&(this.fire("click",a),this._down=null)},d.DOMMouseScroll=function(a){this.fire("mousewheel",a)},d.fire=function(a,b){var c=this._active,d=this._handlers[a];if(c&&d)for(var e=0,f=d.length;f>e;++e)d[e].handler.call(this._obj,b,c)},d.on=function(a,c){var d=b(a),e=this._handlers;return e=e[d]||(e[d]=[]),e.push({type:a,handler:c}),this},d.off=function(a,c){var d=b(a),e=this._handlers[d];if(e){for(var f=e.length;--f>=0;)e[f].type===a&&(c&&e[f].handler!==c||e.splice(f,1));return this}},d.context=function(){return this._canvas.getContext("2d")},d.pick=function(a,b,c,d,e){var f=this.context(),g=a.marktype,h=E.canvas.marks.pick[g];return h.call(this,f,a,b,c,d,e)},c}(),E.svg={},E.svg.marks=function(){function b(a){return a.x||0}function c(a){return a.y||0}function d(a){return a.x+a.width||0}function e(a){return a.y+a.height||0}function f(a){return null==a.size?100:a.size}function g(a){return a.shape||"circle"}function h(a){var b,c,d,e,f,g=a.mark?a:a.length?a[0]:null;if(null!==g)for(b=0,c=I.length;c>b;++b)d=I[b],e=H[d],f=g[d],null==f?"fill"===e?this.style.setProperty(e,"none",null):this.style.removeProperty(e):(f.id&&(E.svg._cur._defs.gradient[f.id]=f,f="url("+window.location.href+"#"+f.id+")"),this.style.setProperty(e,f+"",null))}function i(a){var b=a.x||0,c=a.y||0;this.setAttribute("transform","translate("+b+","+c+")"),this.setAttribute("d",y(a))}function j(a){if(a.length){var b=a[0],c="horizontal"===b.orient?A:z;c.interpolate(b.interpolate||"linear").tension(null==b.tension?.7:b.tension),this.setAttribute("d",c(a))}}function k(a){if(a.length){var b=a[0];B.interpolate(b.interpolate||"linear").tension(null==b.tension?.7:b.tension),this.setAttribute("d",B(a))}}function l(a){var b=a.x||0,c=a.y||0;this.setAttribute("transform","translate("+b+","+c+")"),null!=a.path&&this.setAttribute("d",a.path)}function m(a){this.setAttribute("x",a.x||0),this.setAttribute("y",a.y||0),this.setAttribute("width",a.width||0),this.setAttribute("height",a.height||0)}function n(a){var b=a.x||0,c=a.y||0;this.setAttribute("x1",b),this.setAttribute("y1",c),this.setAttribute("x2",null!=a.x2?a.x2:b),this.setAttribute("y2",null!=a.y2?a.y2:c)}function o(a){var b=a.x||0,c=a.y||0;this.setAttribute("transform","translate("+b+","+c+")"),this.setAttribute("d",C(a))}function p(a){var b=a.width||a.image&&a.image.width||0,c=a.height||a.image&&a.image.height||0,d=a.x-("center"===a.align?b/2:"right"===a.align?b:0),e=a.y-("middle"===a.baseline?c/2:"bottom"===a.baseline?c:0),f=E.data.load.sanitizeUrl(a.url);f&&this.setAttributeNS("http://www.w3.org/1999/xlink","href",f),this.setAttribute("x",d),this.setAttribute("y",e),this.setAttribute("width",b),this.setAttribute("height",c)}function q(a){var b=(a.fontStyle?a.fontStyle+" ":"")+(a.fontVariant?a.fontVariant+" ":"")+(a.fontWeight?a.fontWeight+" ":"")+(null!=a.fontSize?a.fontSize:E.config.render.fontSize)+"px "+(a.font||E.config.render.font);return b}function r(a){var b=a.x||0,c=a.y||0,d=a.dx||0,e=a.dy||0,f=a.angle||0,g=a.radius||0,h=G[a.align||"left"],i="top"===a.baseline?".9em":"middle"===a.baseline?".35em":0;if(g){var j=(a.theta||0)-Math.PI/2;b+=g*Math.cos(j),c+=g*Math.sin(j)}this.setAttribute("x",b+d),this.setAttribute("y",c+e),this.setAttribute("text-anchor",h),f?this.setAttribute("transform","rotate("+f+" "+b+","+c+")"):this.removeAttribute("transform"),i?this.setAttribute("dy",i):this.removeAttribute("dy"),this.textContent=a.text,this.style.setProperty("font",q(a),null)}function s(a){var b=a.x||0,c=a.y||0;if(this.setAttribute("transform","translate("+b+","+c+")"),a.clip){var d={width:a.width||0,height:a.height||0},e=a.clip_id||(a.clip_id="clip"+F++);E.svg._cur._defs.clipping[e]=d,this.setAttribute("clip-path","url(#"+e+")")}}function t(a){var b=a.width||0,c=a.height||0;this.setAttribute("width",b),this.setAttribute("height",c)}function u(a){var b="type-"+a.type;return a.name&&(b+=" "+a.name),b}function v(a,b,c){return function(d,e,f){w(d,e,f,a,b,c)}}function w(b,c,d,e,f,g){var i=g?[c.items]:c.items,j=c.interactive===!1?"none":null,k=b.node().childNodes,l="g"!==e,m=(m=k[d+1])?a.select(m):b.append("g").attr("id","g"+ ++D).attr("class",u(c.def)),n=m.attr("id"),o="#"+n+" > "+e,p=m.selectAll(o).data(i),q=p.enter().append(e);return l?(m.style("pointer-events",j),q.each(function(a){a.mark?a._svg=this:a.length&&(a[0]._svg=this)})):q.append("rect").attr("class","background").style("pointer-events",j),p.exit().remove(),p.each(f),l?p.each(h):m.selectAll(o+" > rect.background").each(t).each(h),m}function x(b,c,d){var e,f,g,h=w(b,c,d,"g",s),i=h.node().childNodes,j=i.length;for(e=0;j>e;++e){var k=i[e].__data__.items,l=i[e].__data__.legendItems||[],m=i[e].__data__.axisItems||[],n=a.select(i[e]),o=0;for(f=0,g=m.length;g>f;++f)"back"===m[f].def.layer&&x.call(this,n,m[f],o++);for(f=0,g=k.length;g>f;++f)this.draw(n,k[f],o++);for(f=0,g=m.length;g>f;++f)"back"!==m[f].def.layer&&x.call(this,n,m[f],o++);for(f=0,g=l.length;g>f;++f)x.call(this,n,l[f],o++)}}var y=a.svg.arc(),z=a.svg.area().x(b).y1(c).y0(e),A=a.svg.area().y(c).x0(d).x1(b),B=a.svg.line().x(b).y(c),C=a.svg.symbol().type(g).size(f),D=0,F=0,G={left:"start",center:"middle",right:"end"},H={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeWidth:"stroke-width",strokeOpacity:"stroke-opacity",strokeCap:"stroke-linecap",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",opacity:"opacity"},I=E.keys(H);return{update:{group:m,area:j,line:k,arc:i,path:l,symbol:o,rect:m,rule:n,text:r,image:p},nested:{area:!0,line:!0},style:h,draw:{group:x,area:v("path",j,!0),line:v("path",k,!0),arc:v("path",i),path:v("path",l),symbol:v("path",o),rect:v("rect",m),rule:v("line",n),text:v("text",r),image:v("image",p),draw:v}}}(),E.svg.Renderer=function(){var b=function(){this._svg=null,this._ctx=null,this._el=null,this._defs={gradient:{},clipping:{}}},c=b.prototype;return c.initialize=function(b,c,d,e,f){return this._el=b,a.select(b).select("svg.marks").remove(),this._svg=a.select(b).append("svg").attr("class","marks"),null!=f&&this._svg.style("background-color",f),this._ctx=this._svg.append("g"),this.resize(c,d,e)},c.resize=function(a,b,c){return this._width=a,this._height=b,this._padding=c,this._svg.attr("width",a+c.left+c.right).attr("height",b+c.top+c.bottom),this._ctx.attr("transform","translate("+c.left+","+c.top+")"),this},c.context=function(){return this._ctx},c.element=function(){return this._el},c.updateDefs=function(){var b,c,d=this._svg,e=this._defs,f=E.keys(e.gradient),g=E.keys(e.clipping),h=d.select("defs");return 0===f.length&&0==g.length?void h.remove():(h.empty()&&(h=d.insert("defs",":first-child")),b=h.selectAll("linearGradient").data(f,E.identity),b.enter().append("linearGradient").attr("id",E.identity),b.exit().remove(),b.each(function(b){var c=e.gradient[b],d=a.select(this);d.attr({x1:c.x1,x2:c.x2,y1:c.y1,y2:c.y2}),stop=d.selectAll("stop").data(c.stops),stop.enter().append("stop"),stop.exit().remove(),stop.attr("offset",function(a){return a.offset}).attr("stop-color",function(a){return a.color})}),c=h.selectAll("clipPath").data(g,E.identity),c.enter().append("clipPath").attr("id",E.identity),c.exit().remove(),void c.each(function(b){var c=e.clipping[b],d=a.select(this).selectAll("rect").data([1]);d.enter().append("rect"),d.attr("x",0).attr("y",0).attr("width",c.width).attr("height",c.height)}))},c.render=function(a,b){E.svg._cur=this,b?this.renderItems(E.array(b)):this.draw(this._ctx,a,-1),this.updateDefs(),delete E.svg._cur},c.renderItems=function(a){var b,c,d,e,f,g=E.svg.marks;for(e=0,f=a.length;f>e;++e)b=a[e],c=b._svg,d=b.mark.marktype,b=g.nested[d]?b.mark.items:b,g.update[d].call(c,b),g.style.call(c,b)},c.draw=function(a,b,c){var d=b.marktype,e=E.svg.marks.draw[d];e.call(this,a,b,c)},b}(),E.svg.Handler=function(){function b(a){var b=this;return function(c){var d=c.target,e=d.__data__;e&&(e=e.mark?e:e[0],a.call(b._obj,c,e))}}function c(a){var b=a.indexOf(".");return 0>b?a:a.slice(0,b)}var d=function(a,b){this._active=null,this._handlers={},a&&this.initialize(a),b&&this.model(b)},e=d.prototype;return e.initialize=function(b,c,d){return this._el=a.select(b).node(),this._svg=a.select(b).select("svg.marks").node(),this._padding=c,this._obj=d||null,this},e.padding=function(a){return this._padding=a,this},e.model=function(a){return arguments.length?(this._model=a,this):this._model},e.handlers=function(){var a=this._handlers;return E.keys(a).reduce(function(b,c){return a[c].reduce(function(a,b){return a.push(b),a},b)},[])},e.on=function(d,e){var f=c(d),g=this._handlers,h=a.select(this._svg).node(),i={type:d,handler:e,svg:b.call(this,e)};return g=g[f]||(g[f]=[]),g.push(i),h.addEventListener(f,i.svg),this},e.off=function(b,d){var e=c(b),f=this._handlers[e],g=a.select(this._svg).node();if(f){for(var h=f.length;--h>=0;)f[h].type===b&&(d&&f[h].handler!==d||(g.removeEventListener(e,f[h].svg),f.splice(h,1)));return this}},d}(),E.data={},E.data.ingestAll=function(a){return E.isTree(a)?h(E.data.ingestTree(a[0],a.children)):a.map(E.data.ingest)},E.data.ingest=function(a,b){return{data:a,index:b}},E.data.ingestTree=function(a,b,c){var d,e,f=E.data.ingest(a,c||0),g=a[b];if(g&&(d=g.length))for(f.values=Array(d),e=0;d>e;++e)f.values[e]=E.data.ingestTree(g[e],b,e);return f},E.data.mapper=function(a){return function(b){return b.forEach(a),b}},E.data.size=function(a,b){return a=E.isArray(a)?a:[0,a],a=a.map(function(a){return"string"==typeof a?b[a]:a})},E.data.load=function(){function b(a){if(E.config.baseURL&&!g.test(a)&&(E.startsWith(a,"/")||"/"===E.config.baseURL[E.config.baseURL.length-1]||(a="/"+a),a=E.config.baseURL+a),E.config.isNode&&E.startsWith(a,"//")&&(a=E.config.defaultProtocol+a),E.config.domainWhiteList){var b,c;if(E.config.isNode){var d=require("url").parse(a);if(E.config.safeMode&&"http:"!==d.protocol&&"https:"!==d.protocol)return!1;b=d.hostname,c=null}else{var e=document.createElement("a");e.href=a,""==e.host&&(e.href=e.href),b=e.hostname.toLowerCase(),c=window.location.hostname}if(c!==b){var f=E.config.domainWhiteList.some(function(a){var c=b.length-a.length;return a===b||c>1&&"."===b[c-1]&&b.lastIndexOf(a)===c});f||(E.error("URL is not whitelisted: "+a),a=!1)}}return a}function c(a,b){var c=E.data.load.sanitizeUrl(a);c?E.config.isNode?E.startsWith(c,h)?e(c.slice(h.length),b):f(c,b):d(c,b):b("Bad URL",null)}function d(b,c){E.log("LOAD XHR: "+b),a.xhr(b,function(a,b){b&&(b=b.responseText),c(a,b)})}function e(a,b){E.log("LOAD FILE: "+a),require("fs").readFile(a,b)}function f(a,b){E.log("LOAD HTTP: "+a);require("request")(a,function(a,c,d){a||200!==c.statusCode?b(a,null):b(null,d)})}var g=/^([A-Za-z]+:)?\/\//,h="file://";return c.sanitizeUrl=b,c}(),E.data.read=function(){function c(a,b){var c=b&&b.type||"json";return a=f[c](a,b),b&&b.parse&&d(a,b.parse),a}function d(a,b){var c=E.keys(b),d=c.map(function(a){return g[b[a]]}),f=E.isTree(a);e(f?[a]:a,c,d,f)}function e(a,b,c,e){var f,g,h,i,j;for(g=0,i=a.length;i>g;++g){for(f=a[g],h=0,j=b.length;j>h;++h)f[b[h]]=c[h](f[b[h]]);e&&f.values&&d(f,b,c,!0)}}var f={},g={number:E.number,"boolean":E["boolean"],date:Date.parse};return f.json=function(a,b){var c=E.isObject(a)?a:JSON.parse(a);return b&&b.property&&(c=E.accessor(b.property)(c)),c},f.csv=function(b,c){var d=a.csv.parse(b);return d},f.tsv=function(b,c){var d=a.tsv.parse(b);return d},f.topojson=function(a,c){if(null==b)return E.error("TopoJSON library not loaded."),[];var d=E.isObject(a)?a:JSON.parse(a),e=[];return c&&c.feature?e=(e=d.objects[c.feature])?b.feature(d,e).features:(E.error("Invalid TopoJSON object: "+c.feature),[]):c&&c.mesh?e=(e=d.objects[c.mesh])?[b.mesh(d,d.objects[c.mesh])]:(E.error("Invalid TopoJSON object: "+c.mesh),[]):E.error("Missing TopoJSON feature or mesh parameter."),e},f.treejson=function(a,b){return a=E.isObject(a)?a:JSON.parse(a),E.tree(a,b.children)},c.formats=f,c.parse=d,c}(),E.data.aggregate=function(){function a(a){this.field=a,this.ops=[],this.flags=0,this.count=0}var b=1,c=2,d=4,e=8,f=16,g=32;return a.prototype.clone=function(){var b,c,d=new a(this.field);for(b in this)c=this[b],d[b]=E.isArray(c)?c.slice():c;return d},a.prototype.init=function(a){"sum"===a?(this.flags|=b,this.sum=0):"avg"===a?(this.flags|=c,this.avg=0):"var"===a||"std"===a?(this.flags|=d|c,this.avg=0,this.dev=0):"min"===a?(this.flags|=e,this.min=+(1/0)):"max"===a?(this.flags|=f,this.max=-(1/0)):"median"===a&&(this.flags|=g,this.vals=[]),this.ops.push(a)},a.prototype.update=function(a){var h,i=this,j=i.flags;i.count+=1,j&b&&(i.sum+=a),j&c&&(h=a-i.avg,i.avg+=h/i.count),j&d&&(i.dev+=h*(a-i.avg)),j&e&&(i.min=a<i.min?a:i.min),j&f&&(i.max=a>i.max?a:i.max),j&g&&i.vals.push(a)},a.prototype.value=function(a){switch(a){case"sum":return this.sum;case"avg":return this.avg;case"var":return this.dev/(this.count-1);case"std":return Math.sqrt(this.dev/(this.count-1));case"min":return this.min;case"max":return this.max;case"median":var b=this.vals,c=b.length,d=~~(c/2);return c?c%2?b[d]:.5*(b[d-1]+b[d]):0}},a.prototype.done=function(a){this.vals&&this.vals.sort(E.numcmp);for(var b=this.ops,c=0;c<b.length;++c)"count"===b[c]?a.count=this.count:a[b[c]+"_"+this.field]=this.value(b[c]);return a},function(){function b(a){var b=f.reduce(function(b,c){return b.push(c(a)),b},[]).join("|");return j[b]||(j[b]=c(a))}function c(a){var b=e.map(function(a){return a.clone()});for(b.data={},i=0;i<h.length;++i)b.data[h[i]]=f[i](a);return b}function d(a){var c,d,e,f,h;for(d=0;d<a.length;++d)for(f=a[d],h=b(f),e=0;e<h.length;++e)h[e].update(g[e](f));var i=[],k=0;for(c in j){for(h=j[c],d=0;d<h.length;++d)h[d].done(h.data);i.push({index:k++,data:h.data})}return j={},i}var e,f,g,h=[],j={};return d.fields=function(b){var c={};return g=[],e=E.array(b).reduce(function(b,d){var e,f=d.field;return c[f]||(g.push(E.accessor(f)),e=0===f.indexOf("data.")?f.slice(5):f,b.push(c[f]=new a(e))),c[f].init(d.op),b},[]),d},d.groupby=function(a){return h=E.array(a),f=h.map(function(a,b){return 0===a.indexOf("data.")&&(h[b]=a.slice(5)),E.accessor(a)}),d},d}}(),E.data.array=function(){function a(a){return a.map(function(a){for(var c=[],d=0,e=b.length;e>d;++d)c.push(b[d](a));return c})}var b=[];return a.fields=function(c){return b=E.array(c).map(E.accessor),a},a},E.data.bin=function(){function a(a){var b={min:null!=e?e:+(1/0),max:null!=f?f:-(1/0),step:null!=g?g:null,maxbins:h};(null==e||null==f)&&a.forEach(function(a){var d=c(a);null==e&&d>b.max&&(b.max=d),null==f&&d<b.min&&(b.min=d)});var i=E.bins(b);return a.forEach(function(a){var b=c(a);d(a,i.start+i.step*~~((b-i.start)/i.step))}),a}var b,c,d,e=void 0,f=void 0,g=void 0,h=20,i="bin";return a.min=function(b){return e=b,a},a.max=function(b){return f=b,a},a.step=function(b){return g=b,a},a.maxbins=function(b){return h=b,a},a.field=function(d){return b=d,c=E.accessor(d),a},a.output=function(b){return i=b,d=E.mutator(b),a},a},E.data.copy=function(){var a=E.accessor("data"),b=[],c=null,d=E.data.mapper(function(d){var e,f,g=a(d),h=c||b;for(e=0,f=b.length;f>e;++e)d[h[e]]=g[b[e]];return d});return d.from=function(b){return a=E.accessor(b),d},d.fields=function(a){return b=E.array(a),d},d.as=function(a){return c=E.array(a),d},d},E.data.cross=function(){function a(a){var e,f,g,h=[],i=b||a,j=a.length;for(f=0;j>f;++f)for(g=0;j>g;++g)c&&f===g||(e={},e[d.left]=a[f],e[d.right]=i[g],h.push(e));return h}var b=null,c=!1,d={left:"a",right:"b"};return a["with"]=function(c){return b=c,a},a.diagonal=function(b){return c=!b,a},a.output=function(b){return E.keys(d).forEach(function(a){void 0!==b[a]&&(d[a]=b[a])}),a},a},E.data.facet=function(){function a(a){var d,e,f,g,h,i,j,k={key:"",keys:[],values:[]},l={},m=k.values;if(0===b.length)return m.push(d={key:"",keys:[],index:0,values:c?a.slice():a}),c&&c(d.values),k;for(h=0,g=a.length;g>h;++h){for(i=0,e=[],f="";i<b.length;++i)j=b[i](a[h]),e.push(j),f+=(i>0?"|":"")+String(j);d=l[f],void 0===d&&m.push(d=l[f]={key:f,keys:e,index:m.length,values:[]}),d.values.push(a[h])}if(c)for(h=0,g=m.length;g>h;++h)c(m[h].values);return k}var b=[],c=null;return a.keys=function(c){return b=E.array(c).map(E.accessor),a},a.sort=function(b){return c=E.data.sort().by(b),a},a},E.data.filter=function(){function a(a){return b?a.filter(b):a}var b=null;return a.test=function(c){return b=E.isFunction(c)?c:E.parse.expr(c),a},a},E.data.flatten=function(){function a(a){return b(a,[])}function b(a,c){if(a.values)for(var d=0,e=a.values.length;e>d;++d)b(a.values[d],c);else c.push(a);return c}return a},E.data.fold=function(){function a(a){var e,f,g,h,i=[],j=b.length;for(f=0,h=a.length;h>f;++f)for(e=a[f],g=0;j>g;++g){var k={index:i.length,data:e.data};k[d.key]=b[g],k[d.value]=c[g](e),i.push(k)}return i}var b=[],c=[],d={key:"key",value:"value"};return a.fields=function(d){return b=E.array(d),c=b.map(E.accessor),a},a.output=function(b){return E.keys(d).forEach(function(a){void 0!==b[a]&&(d[a]=b[a])}),a},a},E.data.force=function(){function b(a,b,e){c.size(E.data.size(i,e)).nodes(a),d&&b[d]&&c.links(b[d]),c.start();for(var f=0;h>f;++f)c.tick();return c.stop(),a}var c=a.layout.force(),d=null,e=20,f=1,g=-30,h=500,i=["width","height"],j=["friction","theta","gravity","alpha"];return b.links=function(a){return d=a,b},b.size=function(a){return i=a,b},b.linkDistance=function(a){return e="number"==typeof a?a:E.accessor(a),c.linkDistance(e),b},b.linkStrength=function(a){return f="number"==typeof a?a:E.accessor(a),c.linkStrength(f),b},b.charge=function(a){return g="number"==typeof a?a:E.accessor(a),c.charge(g),b},b.iterations=function(a){return h=a,b},j.forEach(function(a){b[a]=function(d){return c[a](d),b}}),b},E.data.force.dependencies=["links"],E.data.formula=function(){return function(){var a,b=null,c=E.identity,d=E.data.mapper(function(d,e,f){return b&&a(d,c.call(null,d,e,f)),d});return d.field=function(c){return b=c,a=E.mutator(b),d},d.expr=function(a){return c=E.isFunction(a)?a:E.parse.expr(a),d},d}}(),E.data.geo=function(){function b(){var b={},d="mercator",e=a.geo[d](),f=E.identity,g=E.identity,h={x:"x",y:"y"},i=E.data.mapper(function(a){var b=[g(a),f(a)],c=e(b);return a[h.x]=c[0],a[h.y]=c[1],a});return i.func=function(){return e},i.projection=function(c){if(d!==c){d=c,e=a.geo[d]();for(var f in b)e[f](b[f])}return i},c.forEach(function(a){i[a]=function(c){return b[a]=c,e[a](c),i}}),i.lon=function(a){return g=E.accessor(a),i},i.lat=function(a){return f=E.accessor(a),i},i.output=function(a){return E.keys(h).forEach(function(b){void 0!==a[b]&&(h[b]=a[b])}),a},i}var c=["center","scale","translate","rotate","precision","clipAngle"];return b.params=c,b}(),E.data.geopath=function(){var b=a.geo.path().projection(a.geo.mercator()),c="mercator",d=E.identity,e={},f={path:"path"},g=E.data.mapper(function(a){return a[f.path]=b(d(a)),a});return g.projection=function(d){if(c!==d){c=d;var f=a.geo[c]();for(var h in e)f[h](e[h]);b.projection(f)}return g},E.data.geo.params.forEach(function(a){g[a]=function(c){return e[a]=c,b.projection()[a](c),g}}),g.value=function(a){return d=E.accessor(a),g},g.output=function(a){return E.keys(f).forEach(function(b){void 0!==a[b]&&(f[b]=a[b])}),a},g},E.data.link=function(){function a(a){var b=g(a),c=h(a);return"M"+b.x+","+b.y+"L"+c.x+","+c.y}function b(a){var b=g(a),c=h(a),d=c.x-b.x,e=c.y-b.y,f=i*(d+e),j=i*(e-d);return"M"+b.x+","+b.y+"C"+(b.x+f)+","+(b.y+j)+" "+(c.x+j)+","+(c.y-f)+" "+c.x+","+c.y}function c(a){var b=g(a),c=h(a),d=(b.x+c.x)/2;return"M"+b.x+","+b.y+"C"+d+","+b.y+" "+d+","+c.y+" "+c.x+","+c.y}function d(a){var b=g(a),c=h(a),d=(b.y+c.y)/2;return"M"+b.x+","+b.y+"C"+b.x+","+d+" "+c.x+","+d+" "+c.x+","+c.y}function e(a){var b=k[f];return a.forEach(function(a){a[j.path]=b(a)}),a}var f="line",g=E.accessor("source"),h=E.accessor("target"),i=.2,j={path:"path"},k={line:a,curve:b,diagonal:c,diagonalX:c,diagonalY:d};return e.shape=function(a){return f=a,e},e.tension=function(a){return i=a,e},e.source=function(a){return g=E.accessor(a),e},e.target=function(a){return h=E.accessor(a),e},e.output=function(a){return E.keys(j).forEach(function(b){void 0!==a[b]&&(j[b]=a[b])}),e},e},E.data.pie=function(){function b(b){var c=b.map(function(a,b){return+d(a)}),i=e,j=(f-e)/a.sum(c),k=a.range(b.length);return g&&k.sort(function(a,b){return c[a]-c[b]}),k.forEach(function(a){var d;b[a].value=d=c[a],b[a][h.startAngle]=i,b[a][h.midAngle]=i+.5*d*j,b[a][h.endAngle]=i+=d*j}),b}var c=function(){return 1},d=c,e=0,f=2*Math.PI,g=!1,h={startAngle:"startAngle",endAngle:"endAngle",midAngle:"midAngle"};return b.sort=function(a){return g=a,b},b.value=function(a){return d=a?E.accessor(a):c,b},b.startAngle=function(a){return e=Math.PI*a/180,b},b.endAngle=function(a){return f=Math.PI*a/180,b},b.output=function(a){return E.keys(h).forEach(function(b){void 0!==a[b]&&(h[b]=a[b])}),b},b},E.data.slice=function(){function a(a){if(a=E.values(a),"min"===b)a=[a[E.minIndex(a,c)]];else if("max"===b)a=[a[E.maxIndex(a,c)]];else if("median"===b){var d=a.slice().sort(function(a,b){return a=c(a),b=c(b),b>a?-1:a>b?1:0});a=[a[~~(d.length/2)]]}else{var e=E.array(b);a=a.slice(e[0],e[1])}return a}var b=null,c=E.accessor("data");return a.by=function(c){return b=c,a},a.field=function(b){return c=E.accessor(b),a},a},E.data.sort=function(){function a(a){a=E.isArray(a)?a:a.values||[],a.sort(b);for(var c=0,d=a.length;d>c;++c)a[c].index=c;return a}var b=null;return a.by=function(c){return b=E.comparator(c),a},a},E.data.stack=function(){function b(a){var b=h.y0,e=h.y1,f=h.cy,g=c(a);return 0===g.length?a:(d.out(function(a,c,d){a.datum&&(a.datum[b]=c,a.datum[e]=d+c,a.datum[f]=c+d/2)})(g),a)}function c(a){var b,c,d,g,h,i,j,k,l=E.values(a),m=[],n=[];if(0===l.length)return n;for(c=0,d=l.length;d>c;++c){for(b=E.values(l[c]),g=0,h=b.length;h>g;++g)m.push({x:e(b[g]),y:f(b[g]),z:c,datum:b[g]});n.push([])}for(m.sort(function(a,b){return a.x<b.x?-1:a.x>b.x?1:a.z<b.z?-1:a.z>b.z?1:0}),k=m[0].x,c=0,g=0,i=0,d=m.length;d>i;++i){if(j=m[i],j.x!==k){for(;c<n.length;)n[c++].push({x:g,y:0});k=j.x,c=0,g+=1}for(;j.z>c;)n[c++].push({x:g,y:0});j.x=g,n[c++].push(j)}for(;c<n.length;)n[c++].push({x:g,y:0});return n}var d=a.layout.stack(),e=E.accessor("index"),f=E.accessor("data"),g=["offset","order"],h={y0:"y2",y1:"y",cy:"cy"};return b.point=function(a){return e=E.accessor(a),b},b.height=function(a){return f=E.accessor(a),b},g.forEach(function(a){b[a]=function(c){return d[a](c),b}}),b.output=function(c){return a.keys(h).forEach(function(a){void 0!==c[a]&&(h[a]=c[a])}),b},b},E.data.stats=function(){function a(a){var b,g,h,i,j=+(1/0),k=-(1/0),l=0,m=0,n=0,o=(E.isArray(a)?a:a.values||[]).map(c);for(b=0,g=o.length;g>b;++b)h=o[b],j>h&&(j=h),h>k&&(k=h),l+=h,i=h-m,m+=i/(b+1),n+=i*(h-m);n/=g-1;var p=E.isArray(a)?{}:a;if(e&&(o.sort(E.numcmp),b=o.length>>1,p[f.median]=o.length%2?o[b]:(o[b-1]+o[b])/2),p[f.count]=g,p[f.min]=j,p[f.max]=k,p[f.sum]=l,p[f.mean]=m,p[f.variance]=n,p[f.stdev]=Math.sqrt(n),d){for(o=E.isArray(a)?a:a.values,h={},h[f.count]=g,h[f.min]=j,h[f.max]=k,h[f.sum]=l,h[f.mean]=m,h[f.variance]=n,h[f.stdev]=Math.sqrt(n),e&&(h[f.median]=p[f.median]),b=0,g=o.length;g>b;++b)o[b].stats=h;E.isArray(a)&&(p=o)}return p}function b(b){return E.isArray(b)?a(b):(b.values||[]).map(a)}var c=E.accessor("data"),d=!1,e=!1,f={count:"count",min:"min",max:"max",sum:"sum",mean:"mean",variance:"variance",stdev:"stdev",median:"median"};return b.median=function(a){return e=a||!1,b},b.value=function(a){return c=E.accessor(a),b},b.assign=function(a){return d=a,b},b.output=function(a){return E.keys(f).forEach(function(b){void 0!==a[b]&&(f[b]=a[b])}),b},b},E.data.treemap=function(){function b(a,b,f){a=c.size(E.data.size(e,f)).value(d).nodes(E.isTree(a)?a:{values:a});var h=E.keys(g),i=h.length;return a.forEach(function(a){for(var b,c,d=0;i>d;++d)b=h[d],b!==g[b]&&(c=a[b],delete a[b],a[g[b]]=c)}),a}var c=a.layout.treemap().children(function(a){return a.values}),d=E.accessor("data"),e=["width","height"],f=["round","sticky","ratio","padding"],g={x:"x",y:"y",dx:"width",dy:"height"};return b.size=function(a){return e=a,b},b.value=function(a){return d=E.accessor(a),b},f.forEach(function(a){b[a]=function(d){return c[a](d),b}}),b.output=function(a){return E.keys(g).forEach(function(b){void 0!==a[b]&&(g[b]=a[b])}),b},b},E.data.truncate=function(){var a,b=E.accessor("data"),c="truncate",d="right",e="...",f=!0,g=100,h=E.data.mapper(function(c){var h=E.truncate(b(c),g,d,f,e);return a(c,h),c});return h.value=function(a){return b=E.accessor(a),h},h.output=function(b){return c=b,a=E.mutator(b),h},h.limit=function(a){return g=+a,h},h.position=function(a){return d=a,h},h.ellipsis=function(a){return e=a+"",h},h.wordbreak=function(a){return f=!!a,h},h},E.data.unique=function(){function a(a){return E.unique(a,b).map(function(a){var b={};return b[c]=a,b})}var b=null,c="field";return a.field=function(c){return b=E.accessor(c),a},a.as=function(b){return c=b,a},a},E.data.window=function(){function a(a){a=E.isArray(a)?a:a.values||[];var d,e,f,g=[],h=a.length-b;for(d=0;h>=d;d+=c){for(e=0,f=[];b>e;++e)f.push(a[d+e]);g.push({key:d,values:f})}return{values:g}}var b=2,c=1;return a.size=function(c){return b=c,a},a.step=function(b){return c=b,a},a},E.data.wordcloud=function(){function b(a,b,h){function j(b,d){var e,g,h,j,k,l=c.size(),m=l[0]/2,n=l[1]/2,o=E.keys(i),p=o.length;for(a.sort(function(a,b){return f(b)-f(a)}),h=0,j=b.length;j>h;++h)for(g=a[h],k=0;p>k;++k)e=o[k],g[i[e]]=b[h][e],"x"===e&&(g[i.x]+=m),"y"===e&&(g[i.y]+=n)}return c.size(E.data.size(e,h)).text(d).fontSize(f).rotate(g).words(a).on("end",j).start(),a}var c=a.layout.cloud().size([900,500]),d=E.accessor("data"),e=["width","height"],f=function(){return 14},g=function(){return 0},h=["font","fontStyle","fontWeight","padding"],i={x:"x",y:"y",size:"fontSize",font:"font",rotate:"angle"};return b.text=function(a){return d=E.accessor(a),b},b.size=function(a){return e=a,b},b.fontSize=function(a){return f=E.accessor(a),b},b.rotate=function(a){var c;return E.isObject(a)&&!Array.isArray(a)?void 0!==a.random?(c=(c=a.random)?E.array(c):[0],g=function(){return c[~~(Math.random()*c.length-1e-5)]}):void 0!==a.alternate&&(c=(c=a.alternate)?E.array(c):[0],g=function(a,b){return c[b%c.length]}):g=E.accessor(field),b},h.forEach(function(a){b[a]=function(d){return c[a](d),b}}),b.output=function(a){return E.keys(i).forEach(function(b){void 0!==a[b]&&(i[b]=a[b])}),b},b},E.data.zip=function(){function a(a,g){var h,i,j,k,l,m=g[b],n=m.length;for(f&&(l={},m.forEach(function(a){l[f(a)]=a})),j=0,k=a.length;k>j;++j)i=a[j],i[c]=l?null!=(h=l[d(i)])?h:e:m[j%n];return a}var b=null,c="zip",d=E.accessor("data"),e=void 0,f=null;return a["with"]=function(c){return b=c,a},a["default"]=function(b){return e=b,a},a.as=function(b){return c=b,a},a.key=function(b){return d=E.accessor(b),a},a.withKey=function(b){return f=E.accessor(b),a},a},E.data.zip.dependencies=["with"],E.expression={},E.expression.parse=function(a,b){return M.parse("("+a+")",b)},E.expression.code=function(a){return L(a)};var J={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2"},K=function(a){function b(b,c,d,e){var f=a(c[0]);return d&&(f=d+"("+f+")",E.startsWith(d,"new ")&&(f="("+f+")")),f+"."+b+(0>e?"":0===e?"()":"("+c.slice(1).map(a).join(",")+")")}var c="new Date",d="String",e="RegExp";return{isNaN:"isNaN",isFinite:"isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",now:"Date.now",datetime:"new Date",date:function(a){return b("getDate",a,c,0)},day:function(a){return b("getDay",a,c,0)},year:function(a){return b("getFullYear",a,c,0)},month:function(a){return b("getMonth",a,c,0)},hours:function(a){return b("getHours",a,c,0)},minutes:function(a){return b("getMinutes",a,c,0)},seconds:function(a){return b("getSeconds",a,c,0)},milliseconds:function(a){return b("getMilliseconds",a,c,0)},time:function(a){return b("getTime",a,c,0)},timezoneoffset:function(a){return b("getTimezoneOffset",a,c,0)},utcdate:function(a){return b("getUTCDate",a,c,0)},utcday:function(a){return b("getUTCDay",a,c,0)},utcyear:function(a){return b("getUTCFullYear",a,c,0)},utcmonth:function(a){return b("getUTCMonth",a,c,0)},utchours:function(a){return b("getUTCHours",a,c,0)},utcminutes:function(a){return b("getUTCMinutes",a,c,0)},utcseconds:function(a){return b("getUTCSeconds",a,c,0)},utcmilliseconds:function(a){return b("getUTCMilliseconds",a,c,0)},parseFloat:"parseFloat",parseInt:"parseInt",length:function(a){return b("length",a,null,-1)},upper:function(a){return b("toUpperCase",a,d,0)},lower:function(a){return b("toLowerCase",a,d,0)},slice:function(a){return b("slice",a,d)},substring:function(a){return b("substring",a,d)},test:function(a){return b("test",a,e)},"if":function(b){if(b.length<3)throw new Error("Missing arguments to if function.");if(b.length>3)throw new Error("Too many arguments to if function.");var c=b.map(a);return c[0]+"?"+c[1]+":"+c[2]}}},L=function(a){function b(a){if(a instanceof String)return a;var b=h[a.type];if(null==b)throw new Error("Unsupported type: "+a.type);return b(a)}a=a||{};var c=a.constants||J,d=(a.functions||K)(b),e=a.idWhiteList?E.toMap(a.idWhiteList):null,f=a.idBlackList?E.toMap(a.idBlackList):null,g=0,h={Literal:function(a){return a.raw},Identifier:function(a){var b=a.name;if(g>0)return b;if(c.hasOwnProperty(b))return c[b];if(e){if(e.hasOwnProperty(b))return b;throw new Error("Illegal identifier: "+b)}if(f&&f.hasOwnProperty(b))throw new Error("Illegal identifier: "+b);return b},Program:function(a){return a.body.map(b).join("\n")},MemberExpression:function(a){var c=!a.computed,d=b(a.object);c&&(g+=1);var e=b(a.property);return c&&(g-=1),d+(c?"."+e:"["+e+"]")},CallExpression:function(a){if("Identifier"!==a.callee.type)throw new Error("Illegal callee type: "+a.callee.type);var c=a.callee.name,e=a.arguments,f=d.hasOwnProperty(c)&&d[c];if(!f)throw new Error("Unrecognized function: "+c);return f instanceof Function?f(e):f+"("+e.map(b).join(",")+")"},ArrayExpression:function(a){return"["+a.elements.map(b).join(",")+"]"},BinaryExpression:function(a){return"("+b(a.left)+a.operator+b(a.right)+")"},UnaryExpression:function(a){return"("+a.operator+b(a.argument)+")"},UpdateExpression:function(a){return"("+(prefix?a.operator+b(a.argument):b(a.argument)+a.operator)+")"},ConditionalExpression:function(a){return"("+b(a.test)+"?"+b(a.consequent)+":"+b(a.alternate)+")"},LogicalExpression:function(a){return"("+b(a.left)+a.operator+b(a.right)+")"},ObjectExpression:function(a){return"{"+a.properties.map(b).join(",")+"}"},Property:function(a){g+=1;var c=b(a.key);return g-=1,c+":"+b(a.value)},ExpressionStatement:function(a){return b(a.expression)}};return b},M=function(){"use strict";function a(a,b){if(!a)throw new Error("ASSERT: "+b)}function b(a){return a>=48&&57>=a}function c(a){return"0123456789abcdefABCDEF".indexOf(a)>=0}function d(a){return"01234567".indexOf(a)>=0}function e(a){return 32===a||9===a||11===a||12===a||160===a||a>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(a)>=0;
}function f(a){return 10===a||13===a||8232===a||8233===a}function g(a){return 36===a||95===a||a>=65&&90>=a||a>=97&&122>=a||92===a||a>=128&&ya.NonAsciiIdentifierStart.test(String.fromCharCode(a))}function h(a){return 36===a||95===a||a>=65&&90>=a||a>=97&&122>=a||a>=48&&57>=a||92===a||a>=128&&ya.NonAsciiIdentifierPart.test(String.fromCharCode(a))}function i(a){switch(a){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}function j(a){switch(a){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function k(a){if(Aa&&j(a))return!0;switch(a.length){case 2:return"if"===a||"in"===a||"do"===a;case 3:return"var"===a||"for"===a||"new"===a||"try"===a||"let"===a;case 4:return"this"===a||"else"===a||"case"===a||"void"===a||"with"===a||"enum"===a;case 5:return"while"===a||"break"===a||"catch"===a||"throw"===a||"const"===a||"yield"===a||"class"===a||"super"===a;case 6:return"return"===a||"typeof"===a||"delete"===a||"switch"===a||"export"===a||"import"===a;case 7:return"default"===a||"finally"===a||"extends"===a;case 8:return"function"===a||"continue"===a||"debugger"===a;case 10:return"instanceof"===a;default:return!1}}function l(){var a,b;for(b=0===Ba;Ea>Ba;)if(a=za.charCodeAt(Ba),e(a))++Ba;else{if(!f(a))break;++Ba,13===a&&10===za.charCodeAt(Ba)&&++Ba,++Ca,Da=Ba,b=!0}}function m(a){var b,d,e,f=0;for(d="u"===a?4:2,b=0;d>b;++b){if(!(Ea>Ba&&c(za[Ba])))return"";e=za[Ba++],f=16*f+"0123456789abcdef".indexOf(e.toLowerCase())}return String.fromCharCode(f)}function n(){var a,b,d,e;for(a=za[Ba],b=0,"}"===a&&N({},xa.UnexpectedToken,"ILLEGAL");Ea>Ba&&(a=za[Ba++],c(a));)b=16*b+"0123456789abcdef".indexOf(a.toLowerCase());return(b>1114111||"}"!==a)&&N({},xa.UnexpectedToken,"ILLEGAL"),65535>=b?String.fromCharCode(b):(d=(b-65536>>10)+55296,e=(b-65536&1023)+56320,String.fromCharCode(d,e))}function o(){var a,b;for(a=za.charCodeAt(Ba++),b=String.fromCharCode(a),92===a&&(117!==za.charCodeAt(Ba)&&N({},xa.UnexpectedToken,"ILLEGAL"),++Ba,a=m("u"),a&&"\\"!==a&&g(a.charCodeAt(0))||N({},xa.UnexpectedToken,"ILLEGAL"),b=a);Ea>Ba&&(a=za.charCodeAt(Ba),h(a));)++Ba,b+=String.fromCharCode(a),92===a&&(b=b.substr(0,b.length-1),117!==za.charCodeAt(Ba)&&N({},xa.UnexpectedToken,"ILLEGAL"),++Ba,a=m("u"),a&&"\\"!==a&&h(a.charCodeAt(0))||N({},xa.UnexpectedToken,"ILLEGAL"),b+=a);return b}function p(){var a,b;for(a=Ba++;Ea>Ba;){if(b=za.charCodeAt(Ba),92===b)return Ba=a,o();if(!h(b))break;++Ba}return za.slice(a,Ba)}function q(){var a,b,c;return a=Ba,b=92===za.charCodeAt(Ba)?o():p(),c=1===b.length?ta.Identifier:k(b)?ta.Keyword:"null"===b?ta.NullLiteral:"true"===b||"false"===b?ta.BooleanLiteral:ta.Identifier,{type:c,value:b,lineNumber:Ca,lineStart:Da,start:a,end:Ba}}function r(){var a,b,c,d,e=Ba,f=za.charCodeAt(Ba),g=za[Ba];switch(f){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Ba,Ha.tokenize&&(40===f?Ha.openParenToken=Ha.tokens.length:123===f&&(Ha.openCurlyToken=Ha.tokens.length)),{type:ta.Punctuator,value:String.fromCharCode(f),lineNumber:Ca,lineStart:Da,start:e,end:Ba};default:if(a=za.charCodeAt(Ba+1),61===a)switch(f){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Ba+=2,{type:ta.Punctuator,value:String.fromCharCode(f)+String.fromCharCode(a),lineNumber:Ca,lineStart:Da,start:e,end:Ba};case 33:case 61:return Ba+=2,61===za.charCodeAt(Ba)&&++Ba,{type:ta.Punctuator,value:za.slice(e,Ba),lineNumber:Ca,lineStart:Da,start:e,end:Ba}}}return d=za.substr(Ba,4),">>>="===d?(Ba+=4,{type:ta.Punctuator,value:d,lineNumber:Ca,lineStart:Da,start:e,end:Ba}):(c=d.substr(0,3),">>>"===c||"<<="===c||">>="===c?(Ba+=3,{type:ta.Punctuator,value:c,lineNumber:Ca,lineStart:Da,start:e,end:Ba}):(b=c.substr(0,2),g===b[1]&&"+-<>&|".indexOf(g)>=0||"=>"===b?(Ba+=2,{type:ta.Punctuator,value:b,lineNumber:Ca,lineStart:Da,start:e,end:Ba}):"<>=!+-*%&|^/".indexOf(g)>=0?(++Ba,{type:ta.Punctuator,value:g,lineNumber:Ca,lineStart:Da,start:e,end:Ba}):void N({},xa.UnexpectedToken,"ILLEGAL")))}function s(a){for(var b="";Ea>Ba&&c(za[Ba]);)b+=za[Ba++];return 0===b.length&&N({},xa.UnexpectedToken,"ILLEGAL"),g(za.charCodeAt(Ba))&&N({},xa.UnexpectedToken,"ILLEGAL"),{type:ta.NumericLiteral,value:parseInt("0x"+b,16),lineNumber:Ca,lineStart:Da,start:a,end:Ba}}function t(a){for(var c="0"+za[Ba++];Ea>Ba&&d(za[Ba]);)c+=za[Ba++];return(g(za.charCodeAt(Ba))||b(za.charCodeAt(Ba)))&&N({},xa.UnexpectedToken,"ILLEGAL"),{type:ta.NumericLiteral,value:parseInt(c,8),octal:!0,lineNumber:Ca,lineStart:Da,start:a,end:Ba}}function u(){var c,e,f;if(f=za[Ba],a(b(f.charCodeAt(0))||"."===f,"Numeric literal must start with a decimal digit or a decimal point"),e=Ba,c="","."!==f){if(c=za[Ba++],f=za[Ba],"0"===c){if("x"===f||"X"===f)return++Ba,s(e);if(d(f))return t(e);f&&b(f.charCodeAt(0))&&N({},xa.UnexpectedToken,"ILLEGAL")}for(;b(za.charCodeAt(Ba));)c+=za[Ba++];f=za[Ba]}if("."===f){for(c+=za[Ba++];b(za.charCodeAt(Ba));)c+=za[Ba++];f=za[Ba]}if("e"===f||"E"===f)if(c+=za[Ba++],f=za[Ba],("+"===f||"-"===f)&&(c+=za[Ba++]),b(za.charCodeAt(Ba)))for(;b(za.charCodeAt(Ba));)c+=za[Ba++];else N({},xa.UnexpectedToken,"ILLEGAL");return g(za.charCodeAt(Ba))&&N({},xa.UnexpectedToken,"ILLEGAL"),{type:ta.NumericLiteral,value:parseFloat(c),lineNumber:Ca,lineStart:Da,start:e,end:Ba}}function v(){var b,c,e,g,h,i,j,k,l="",o=!1;for(j=Ca,k=Da,b=za[Ba],a("'"===b||'"'===b,"String literal must starts with a quote"),c=Ba,++Ba;Ea>Ba;){if(e=za[Ba++],e===b){b="";break}if("\\"===e)if(e=za[Ba++],e&&f(e.charCodeAt(0)))++Ca,"\r"===e&&"\n"===za[Ba]&&++Ba,Da=Ba;else switch(e){case"u":case"x":"{"===za[Ba]?(++Ba,l+=n()):(i=Ba,h=m(e),h?l+=h:(Ba=i,l+=e));break;case"n":l+="\n";break;case"r":l+="\r";break;case"t":l+="	";break;case"b":l+="\b";break;case"f":l+="\f";break;case"v":l+="\x0B";break;default:d(e)?(g="01234567".indexOf(e),0!==g&&(o=!0),Ea>Ba&&d(za[Ba])&&(o=!0,g=8*g+"01234567".indexOf(za[Ba++]),"0123".indexOf(e)>=0&&Ea>Ba&&d(za[Ba])&&(g=8*g+"01234567".indexOf(za[Ba++]))),l+=String.fromCharCode(g)):l+=e}else{if(f(e.charCodeAt(0)))break;l+=e}}return""!==b&&N({},xa.UnexpectedToken,"ILLEGAL"),{type:ta.StringLiteral,value:l,octal:o,startLineNumber:j,startLineStart:k,lineNumber:Ca,lineStart:Da,start:c,end:Ba}}function w(a,b){var c,d=a;b.indexOf("u")>=0&&(d=d.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(a,b){return parseInt(b,16)<=1114111?"x":void N({},xa.InvalidRegExp)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{c=new RegExp(d)}catch(e){N({},xa.InvalidRegExp)}try{return new RegExp(a,b)}catch(f){return null}}function x(){var b,c,d,e,g;for(b=za[Ba],a("/"===b,"Regular expression literal must start with a slash"),c=za[Ba++],d=!1,e=!1;Ea>Ba;)if(b=za[Ba++],c+=b,"\\"===b)b=za[Ba++],f(b.charCodeAt(0))&&N({},xa.UnterminatedRegExp),c+=b;else if(f(b.charCodeAt(0)))N({},xa.UnterminatedRegExp);else if(d)"]"===b&&(d=!1);else{if("/"===b){e=!0;break}"["===b&&(d=!0)}return e||N({},xa.UnterminatedRegExp),g=c.substr(1,c.length-2),{value:g,literal:c}}function y(){var a,b,c,d;for(b="",c="";Ea>Ba&&(a=za[Ba],h(a.charCodeAt(0)));)if(++Ba,"\\"===a&&Ea>Ba)if(a=za[Ba],"u"===a){if(++Ba,d=Ba,a=m("u"))for(c+=a,b+="\\u";Ba>d;++d)b+=za[d];else Ba=d,c+="u",b+="\\u";O({},xa.UnexpectedToken,"ILLEGAL")}else b+="\\",O({},xa.UnexpectedToken,"ILLEGAL");else c+=a,b+=a;return{value:c,literal:b}}function z(){var a,b,c,d;return Fa=null,l(),a=Ba,b=x(),c=y(),d=w(b.value,c.value),Ha.tokenize?{type:ta.RegularExpression,value:d,regex:{pattern:b.value,flags:c.value},lineNumber:Ca,lineStart:Da,start:a,end:Ba}:{literal:b.literal+c.literal,value:d,regex:{pattern:b.value,flags:c.value},start:a,end:Ba}}function A(){var a,b,c,d;return l(),a=Ba,b={start:{line:Ca,column:Ba-Da}},c=z(),b.end={line:Ca,column:Ba-Da},Ha.tokenize||(Ha.tokens.length>0&&(d=Ha.tokens[Ha.tokens.length-1],d.range[0]===a&&"Punctuator"===d.type&&("/"===d.value||"/="===d.value)&&Ha.tokens.pop()),Ha.tokens.push({type:"RegularExpression",value:c.literal,regex:c.regex,range:[a,Ba],loc:b})),c}function B(a){return a.type===ta.Identifier||a.type===ta.Keyword||a.type===ta.BooleanLiteral||a.type===ta.NullLiteral}function C(){var a,b;if(a=Ha.tokens[Ha.tokens.length-1],!a)return A();if("Punctuator"===a.type){if("]"===a.value)return r();if(")"===a.value)return b=Ha.tokens[Ha.openParenToken-1],!b||"Keyword"!==b.type||"if"!==b.value&&"while"!==b.value&&"for"!==b.value&&"with"!==b.value?r():A();if("}"===a.value){if(Ha.tokens[Ha.openCurlyToken-3]&&"Keyword"===Ha.tokens[Ha.openCurlyToken-3].type){if(b=Ha.tokens[Ha.openCurlyToken-4],!b)return r()}else{if(!Ha.tokens[Ha.openCurlyToken-4]||"Keyword"!==Ha.tokens[Ha.openCurlyToken-4].type)return r();if(b=Ha.tokens[Ha.openCurlyToken-5],!b)return A()}return r()}return A()}return"Keyword"===a.type&&"this"!==a.value?A():r()}function D(){var a;return l(),Ba>=Ea?{type:ta.EOF,lineNumber:Ca,lineStart:Da,start:Ba,end:Ba}:(a=za.charCodeAt(Ba),g(a)?q():40===a||41===a||59===a?r():39===a||34===a?v():46===a?b(za.charCodeAt(Ba+1))?u():r():b(a)?u():Ha.tokenize&&47===a?C():r())}function E(){var a,b,c,d;return l(),a={start:{line:Ca,column:Ba-Da}},b=D(),a.end={line:Ca,column:Ba-Da},b.type!==ta.EOF&&(c=za.slice(b.start,b.end),d={type:ua[b.type],value:c,range:[b.start,b.end],loc:a},b.regex&&(d.regex={pattern:b.regex.pattern,flags:b.regex.flags}),Ha.tokens.push(d)),b}function F(){var a;return a=Fa,Ba=a.end,Ca=a.lineNumber,Da=a.lineStart,Fa="undefined"!=typeof Ha.tokens?E():D(),Ba=a.end,Ca=a.lineNumber,Da=a.lineStart,a}function G(){var a,b,c;a=Ba,b=Ca,c=Da,Fa="undefined"!=typeof Ha.tokens?E():D(),Ba=a,Ca=b,Da=c}function H(){this.line=Ca,this.column=Ba-Da}function I(){this.start=new H,this.end=null}function J(a){a.type===ta.StringLiteral?this.start={line:a.startLineNumber,column:a.start-a.startLineStart}:this.start={line:a.lineNumber,column:a.start-a.lineStart},this.end=null}function K(){Ba=Fa.start,Fa.type===ta.StringLiteral?(Ca=Fa.startLineNumber,Da=Fa.startLineStart):(Ca=Fa.lineNumber,Da=Fa.lineStart),Ha.range&&(this.range=[Ba,0]),Ha.loc&&(this.loc=new I)}function L(a){Ha.range&&(this.range=[a.start,0]),Ha.loc&&(this.loc=new J(a))}function M(){var a,b,c,d;return a=Ba,b=Ca,c=Da,l(),d=Ca!==b,Ba=a,Ca=b,Da=c,d}function N(b,c){var d,e=Array.prototype.slice.call(arguments,2),f=c.replace(/%(\d)/g,function(b,c){return a(c<e.length,"Message reference must be in range"),e[c]});throw"number"==typeof b.lineNumber?(d=new Error("Line "+b.lineNumber+": "+f),d.index=b.start,d.lineNumber=b.lineNumber,d.column=b.start-Da+1):(d=new Error("Line "+Ca+": "+f),d.index=Ba,d.lineNumber=Ca,d.column=Ba-Da+1),d.description=f,d}function O(){try{N.apply(null,arguments)}catch(a){if(!Ha.errors)throw a;Ha.errors.push(a)}}function P(a){if(a.type===ta.EOF&&N(a,xa.UnexpectedEOS),a.type===ta.NumericLiteral&&N(a,xa.UnexpectedNumber),a.type===ta.StringLiteral&&N(a,xa.UnexpectedString),a.type===ta.Identifier&&N(a,xa.UnexpectedIdentifier),a.type===ta.Keyword){if(i(a.value))N(a,xa.UnexpectedReserved);else if(Aa&&j(a.value))return void O(a,xa.StrictReservedWord);N(a,xa.UnexpectedToken,a.value)}N(a,xa.UnexpectedToken,a.value)}function Q(a){var b=F();(b.type!==ta.Punctuator||b.value!==a)&&P(b)}function R(a){if(Ha.errors){var b=Fa;b.type!==ta.Punctuator&&b.value!==a?O(b,xa.UnexpectedToken,b.value):F()}else Q(a)}function S(a){return Fa.type===ta.Punctuator&&Fa.value===a}function T(a){return Fa.type===ta.Keyword&&Fa.value===a}function U(){var a;return 59===za.charCodeAt(Ba)||S(";")?void F():(a=Ca,l(),void(Ca===a&&(Fa.type===ta.EOF||S("}")||P(Fa))))}function V(){var a=[],b=new K;for(Q("[");!S("]");)S(",")?(F(),a.push(null)):(a.push(ja()),S("]")||Q(","));return F(),b.finishArrayExpression(a)}function W(){var a,b=new K;return a=F(),a.type===ta.StringLiteral||a.type===ta.NumericLiteral?(Aa&&a.octal&&O(a,xa.StrictOctalLiteral),b.finishLiteral(a)):b.finishIdentifier(a.value)}function X(){var a,b,c,d,e=new K;return a=Fa,a.type===ta.Identifier?(c=W(),Q(":"),d=ja(),e.finishProperty("init",c,d)):a.type!==ta.EOF&&a.type!==ta.Punctuator?(b=W(),Q(":"),d=ja(),e.finishProperty("init",b,d)):void P(a)}function Y(){var a,b,c,d,e=[],f={},g=String,h=new K;for(Q("{");!S("}");)a=X(),b=a.key.type===va.Identifier?a.key.name:g(a.key.value),d="init"===a.kind?wa.Data:"get"===a.kind?wa.Get:wa.Set,c="$"+b,Object.prototype.hasOwnProperty.call(f,c)?(f[c]===wa.Data?Aa&&d===wa.Data?O({},xa.StrictDuplicateProperty):d!==wa.Data&&O({},xa.AccessorDataProperty):d===wa.Data?O({},xa.AccessorDataProperty):f[c]&d&&O({},xa.AccessorGetSet),f[c]|=d):f[c]=d,e.push(a),S("}")||R(",");return Q("}"),h.finishObjectExpression(e)}function Z(){var a;return Q("("),++Ga.parenthesisCount,a=ka(),Q(")"),a}function $(){var a,b,c,d;if(S("("))return Z();if(S("["))return V();if(S("{"))return Y();if(a=Fa.type,d=new K,a===ta.Identifier||Ia[Fa.value])c=d.finishIdentifier(F().value);else if(a===ta.StringLiteral||a===ta.NumericLiteral)Aa&&Fa.octal&&O(Fa,xa.StrictOctalLiteral),c=d.finishLiteral(F());else{if(a===ta.Keyword)throw new Error("Disabled.");a===ta.BooleanLiteral?(b=F(),b.value="true"===b.value,c=d.finishLiteral(b)):a===ta.NullLiteral?(b=F(),b.value=null,c=d.finishLiteral(b)):S("/")||S("/=")?(c="undefined"!=typeof Ha.tokens?d.finishLiteral(A()):d.finishLiteral(z()),G()):P(F())}return c}function _(){var a=[];if(Q("("),!S(")"))for(;Ea>Ba&&(a.push(ja()),!S(")"));)R(",");return Q(")"),a}function aa(){var a,b=new K;return a=F(),B(a)||P(a),b.finishIdentifier(a.value)}function ba(){return Q("."),aa()}function ca(){var a;return Q("["),a=ka(),Q("]"),a}function da(){var a,b,c,d,e=Ga.allowIn;for(d=Fa,Ga.allowIn=!0,a=$();;)if(S("."))c=ba(),a=new L(d).finishMemberExpression(".",a,c);else if(S("("))b=_(),a=new L(d).finishCallExpression(a,b);else{if(!S("["))break;c=ca(),a=new L(d).finishMemberExpression("[",a,c)}return Ga.allowIn=e,a}function ea(){var a;if(a=da(),Fa.type===ta.Punctuator&&(S("++")||S("--"))&&!M())throw new Error("Disabled.");return a}function fa(){var a,b,c;if(Fa.type!==ta.Punctuator&&Fa.type!==ta.Keyword)b=ea();else{if(S("++")||S("--"))throw new Error("Disabled.");if(S("+")||S("-")||S("~")||S("!"))c=Fa,a=F(),b=fa(),b=new L(c).finishUnaryExpression(a.value,b);else{if(T("delete")||T("void")||T("typeof"))throw new Error("Disabled.");b=ea()}}return b}function ga(a,b){var c=0;if(a.type!==ta.Punctuator&&a.type!==ta.Keyword)return 0;switch(a.value){case"||":c=1;break;case"&&":c=2;break;case"|":c=3;break;case"^":c=4;break;case"&":c=5;break;case"==":case"!=":case"===":case"!==":c=6;break;case"<":case">":case"<=":case">=":case"instanceof":c=7;break;case"in":c=b?7:0;break;case"<<":case">>":case">>>":c=8;break;case"+":case"-":c=9;break;case"*":case"/":case"%":c=11}return c}function ha(){var a,b,c,d,e,f,g,h,i,j;if(a=Fa,i=fa(),d=Fa,e=ga(d,Ga.allowIn),0===e)return i;for(d.prec=e,F(),b=[a,Fa],g=fa(),f=[i,d,g];(e=ga(Fa,Ga.allowIn))>0;){for(;f.length>2&&e<=f[f.length-2].prec;)g=f.pop(),h=f.pop().value,i=f.pop(),b.pop(),c=new L(b[b.length-1]).finishBinaryExpression(h,i,g),f.push(c);d=F(),d.prec=e,f.push(d),b.push(Fa),c=fa(),f.push(c)}for(j=f.length-1,c=f[j],b.pop();j>1;)c=new L(b.pop()).finishBinaryExpression(f[j-1].value,f[j-2],c),j-=2;return c}function ia(){var a,b,c,d,e;return e=Fa,a=ha(),S("?")&&(F(),b=Ga.allowIn,Ga.allowIn=!0,c=ja(),Ga.allowIn=b,Q(":"),d=ja(),a=new L(e).finishConditionalExpression(a,c,d)),a}function ja(){var a,b,c,d;return a=Ga.parenthesisCount,d=Fa,b=Fa,c=ia()}function ka(){var a;if(a=ja(),S(","))throw new Error("Disabled.");return a}function la(a){var b=ka();return U(),a.finishExpressionStatement(b)}function ma(){var a,b,c=Fa.type;if(c===ta.EOF&&P(Fa),c===ta.Punctuator&&"{"===Fa.value)throw new Error("Disabled.");if(b=new K,c===ta.Punctuator)switch(Fa.value){case";":throw new Error("Disabled.");case"(":return la(b)}else if(c===ta.Keyword)throw new Error("Disabled.");return a=ka(),U(),b.finishExpressionStatement(a)}function na(){if(Fa.type===ta.Keyword)switch(Fa.value){case"const":case"let":throw new Error("Disabled.");case"function":throw new Error("Disabled.");default:return ma()}return Fa.type!==ta.EOF?ma():void 0}function oa(){for(var a,b,c,d,e=[];Ea>Ba&&(b=Fa,b.type===ta.StringLiteral)&&(a=na(),e.push(a),a.expression.type===va.Literal);)c=za.slice(b.start+1,b.end-1),"use strict"===c?(Aa=!0,d&&O(d,xa.StrictOctalLiteral)):!d&&b.octal&&(d=b);for(;Ea>Ba&&(a=na(),"undefined"!=typeof a);)e.push(a);return e}function pa(){var a,b;return l(),G(),b=new K,Aa=!0,a=oa(),b.finishProgram(a)}function qa(){var a,b,c,d=[];for(a=0;a<Ha.tokens.length;++a)b=Ha.tokens[a],c={type:b.type,value:b.value},b.regex&&(c.regex={pattern:b.regex.pattern,flags:b.regex.flags}),Ha.range&&(c.range=b.range),Ha.loc&&(c.loc=b.loc),d.push(c);Ha.tokens=d}function ra(a,b){var c,d;c=String,"string"==typeof a||a instanceof String||(a=c(a)),za=a,Ba=0,Ca=za.length>0?1:0,Da=0,Ea=za.length,Fa=null,Ga={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},Ha={},b=b||{},b.tokens=!0,Ha.tokens=[],Ha.tokenize=!0,Ha.openParenToken=-1,Ha.openCurlyToken=-1,Ha.range="boolean"==typeof b.range&&b.range,Ha.loc="boolean"==typeof b.loc&&b.loc,"boolean"==typeof b.tolerant&&b.tolerant&&(Ha.errors=[]);try{if(G(),Fa.type===ta.EOF)return Ha.tokens;for(F();Fa.type!==ta.EOF;)try{F()}catch(e){if(Ha.errors){Ha.errors.push(e);break}throw e}qa(),d=Ha.tokens,"undefined"!=typeof Ha.errors&&(d.errors=Ha.errors)}catch(f){throw f}finally{Ha={}}return d}function sa(a,b){var c,d;d=String,"string"==typeof a||a instanceof String||(a=d(a)),za=a,Ba=0,Ca=za.length>0?1:0,Da=0,Ea=za.length,Fa=null,Ga={allowIn:!0,labelSet:{},parenthesisCount:0,inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},Ha={},"undefined"!=typeof b&&(Ha.range="boolean"==typeof b.range&&b.range,Ha.loc="boolean"==typeof b.loc&&b.loc,Ha.loc&&null!==b.source&&void 0!==b.source&&(Ha.source=d(b.source)),"boolean"==typeof b.tokens&&b.tokens&&(Ha.tokens=[]),"boolean"==typeof b.tolerant&&b.tolerant&&(Ha.errors=[]));try{c=pa(),"undefined"!=typeof Ha.tokens&&(qa(),c.tokens=Ha.tokens),"undefined"!=typeof Ha.errors&&(c.errors=Ha.errors)}catch(e){throw e}finally{Ha={}}return c}var ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha;ta={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9},ua={},ua[ta.BooleanLiteral]="Boolean",ua[ta.EOF]="<end>",ua[ta.Identifier]="Identifier",ua[ta.Keyword]="Keyword",ua[ta.NullLiteral]="Null",ua[ta.NumericLiteral]="Numeric",ua[ta.Punctuator]="Punctuator",ua[ta.StringLiteral]="String",ua[ta.RegularExpression]="RegularExpression",va={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BinaryExpression:"BinaryExpression",CallExpression:"CallExpression",ConditionalExpression:"ConditionalExpression",ExpressionStatement:"ExpressionStatement",Identifier:"Identifier",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression"},wa={Data:1,Get:2,Set:4},xa={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},ya={NonAsciiIdentifierStart:new RegExp("[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"),NonAsciiIdentifierPart:new RegExp("[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]")},L.prototype=K.prototype={finish:function(){Ha.range&&(this.range[1]=Ba),Ha.loc&&(this.loc.end=new H,Ha.source&&(this.loc.source=Ha.source))},finishArrayExpression:function(a){return this.type=va.ArrayExpression,this.elements=a,this.finish(),this},finishAssignmentExpression:function(a,b,c){return this.type=va.AssignmentExpression,this.operator=a,this.left=b,this.right=c,this.finish(),this},finishBinaryExpression:function(a,b,c){return this.type="||"===a||"&&"===a?va.LogicalExpression:va.BinaryExpression,this.operator=a,this.left=b,this.right=c,this.finish(),this},finishCallExpression:function(a,b){return this.type=va.CallExpression,this.callee=a,this.arguments=b,this.finish(),this},finishConditionalExpression:function(a,b,c){return this.type=va.ConditionalExpression,this.test=a,this.consequent=b,this.alternate=c,this.finish(),this},finishExpressionStatement:function(a){return this.type=va.ExpressionStatement,this.expression=a,this.finish(),this},finishIdentifier:function(a){return this.type=va.Identifier,this.name=a,this.finish(),this},finishLiteral:function(a){return this.type=va.Literal,this.value=a.value,this.raw=za.slice(a.start,a.end),a.regex&&(this.regex=a.regex),this.finish(),this},finishMemberExpression:function(a,b,c){return this.type=va.MemberExpression,this.computed="["===a,this.object=b,this.property=c,this.finish(),this},finishObjectExpression:function(a){return this.type=va.ObjectExpression,this.properties=a,this.finish(),this},finishProgram:function(a){return this.type=va.Program,
this.body=a,this.finish(),this},finishProperty:function(a,b,c){return this.type=va.Property,this.key=b,this.value=c,this.kind=a,this.finish(),this},finishUnaryExpression:function(a,b){return this.type="++"===a||"--"===a?va.UpdateExpression:va.UnaryExpression,this.operator=a,this.argument=b,this.prefix=!0,this.finish(),this}};var Ia={"if":1,"this":1};return{tokenize:ra,parse:sa}}();E.parse={},E.parse.axes=function(){function a(a,c,d){(a||[]).forEach(function(a,e){c[e]=c[e]||E.scene.axis(),b(a,e,c[e],d)})}function b(a,b,d,e){void 0!==a.scale&&d.scale(e[a.scale]),d.orient(a.orient||c[a.type]),d.offset(a.offset||0),d.layer(a.layer||"front"),d.grid(a.grid||!1),d.title(a.title||null),d.titleOffset(null!=a.titleOffset?a.titleOffset:E.config.axis.titleOffset),d.tickValues(a.values||null),d.tickFormat(a.format||null),d.tickSubdivide(a.subdivide||0),d.tickPadding(a.tickPadding||E.config.axis.padding);var f=[];if(void 0!==a.tickSize)for(var g=0;3>g;++g)f.push(a.tickSize);else{var h=E.config.axis.tickSize;f=[h,h,h]}null!=a.tickSizeMajor&&(f[0]=a.tickSizeMajor),null!=a.tickSizeMinor&&(f[1]=a.tickSizeMinor),null!=a.tickSizeEnd&&(f[2]=a.tickSizeEnd),f.length&&d.tickSize.apply(d,f),d.tickCount(a.ticks||E.config.axis.ticks);var i=a.properties;i&&i.ticks?(d.majorTickProperties(i.majorTicks?E.extend({},i.ticks,i.majorTicks):i.ticks),d.minorTickProperties(i.minorTicks?E.extend({},i.ticks,i.minorTicks):i.ticks)):(d.majorTickProperties(i&&i.majorTicks||{}),d.minorTickProperties(i&&i.minorTicks||{})),d.tickLabelProperties(i&&i.labels||{}),d.titleProperties(i&&i.title||{}),d.gridLineProperties(i&&i.grid||{}),d.domainProperties(i&&i.axis||{})}var c={x:"bottom",y:"left",top:"top",bottom:"bottom",left:"left",right:"right"};return a}(),E.parse.background=function(b){return null==b?null:a.rgb(b)+""},E.parse.data=function(a,b){function c(a){return function(c,d){c?E.error("LOADING FAILED: "+a.url):e.load[a.name]=E.data.read(d.toString(),a.format),0===--f&&b()}}function d(a){1!==j[a]&&(j[a]||(j[a]=1,(e.source[a]||[]).forEach(d),(e.deps[a]||[]).forEach(d),j[a]=2,i.push(a)))}var e={defs:a,load:{},flow:{},deps:{},source:{},sorted:null},f=0;(a||[]).forEach(function(a){if(a.url?(f+=1,E.data.load(a.url,c(a))):a.values?e.load[a.name]=E.data.read(a.values,a.format):a.source&&(e.source[a.source]||(e.source[a.source]=[])).push(a.name),a.transform){var b=E.parse.dataflow(a);e.flow[a.name]=b,b.dependencies.forEach(function(b){(e.deps[b]||(e.deps[b]=[])).push(a.name)})}});for(var g,h=(a||[]).map(E.accessor("name")),i=[],j={};h.length;)2!==j[g=h.pop()]&&d(g);return e.sorted=i.reverse(),0===f&&setTimeout(b,1),e},E.parse.dataflow=function(a){var b=(a.transform||[]).map(E.parse.transform),c=b.length?function(a,c,d){return b.reduce(function(a,b){return b(a,c,d)},a)}:E.identity;return c.transforms=b,c.dependencies=E.keys((a.transform||[]).reduce(function(a,b){var c=E.data[b.type].dependencies;return c&&c.forEach(function(c){b[c]&&(a[b[c]]=1)}),a},{})),c},E.parse.expr=function(){var a=E.expression.parse,b=E.expression.code({idWhiteList:["d","index","data"]});return function(c){var d=b(a(c));return Function("d","index","data",'"use strict"; return ('+d+");")}}(),E.parse.legends=function(){function a(a,c,d){(a||[]).forEach(function(a,e){c[e]=c[e]||E.scene.legend(),b(a,e,c[e],d)})}function b(a,b,c,d){c.size(a.size?d[a.size]:null),c.shape(a.shape?d[a.shape]:null),c.fill(a.fill?d[a.fill]:null),c.stroke(a.stroke?d[a.stroke]:null),a.orient&&c.orient(a.orient),null!=a.offset&&c.offset(a.offset),c.title(a.title||null),c.values(a.values||null),c.format(void 0!==a.format?a.format:null);var e=a.properties;c.titleProperties(e&&e.title||{}),c.labelProperties(e&&e.labels||{}),c.legendProperties(e&&e.legend||{}),c.symbolProperties(e&&e.symbols||{}),c.gradientProperties(e&&e.gradient||{})}return a}(),E.parse.mark=function(a){var b=a.properties,c=a.marks;if(E.keys(b).forEach(function(c){b[c]=E.parse.properties(a.type,b[c])}),a.delay&&(a.delay=E.parse.properties(a.type,{delay:a.delay})),a.from){var d=a.from.data,e=E.parse.dataflow(a.from);a.from=function(a,b,c){var f=E.scene.data(d?a[d]:null,c);return e(f,a,b)}}return c&&(a.marks=c.map(E.parse.mark)),a},E.parse.marks=function(a,b,c){return{type:"group",width:b,height:c,scales:a.scales||[],axes:a.axes||[],legends:a.legends||[],marks:(a.marks||[]).map(E.parse.mark)}},E.parse.padding=function(a){if(null==a)return"auto";if(E.isString(a))return"strict"===a?"strict":"auto";if(E.isObject(a))return a;var b=E.isNumber(a)?a:20;return{top:b,left:b,right:b,bottom:b}},E.parse.properties=function(){function a(a,d){var e,f,g,h,i="",j=E.keys(d),k={};for(i+="var o = trans ? {} : item;\n",e=0,f=j.length;f>e;++e)h=d[g=j[e]],i+=e>0?"\n  ":"  ",i+="o."+g+" = "+c(g,h)+";",k[g]=!0;k.x2&&(k.x?(i+="\n  if (o.x > o.x2) { var t = o.x; o.x = o.x2; o.x2 = t; };",i+="\n  o.width = (o.x2 - o.x);"):i+=k.width?"\n  o.x = (o.x2 - o.width);":"\n  o.x = o.x2;"),k.xc&&(i+=k.width?"\n  o.x = (o.xc - o.width/2);":"\n  o.x = o.xc;"),k.y2&&(k.y?(i+="\n  if (o.y > o.y2) { var t = o.y; o.y = o.y2; o.y2 = t; };",i+="\n  o.height = (o.y2 - o.y);"):i+=k.height?"\n  o.y = (o.y2 - o.height);":"\n  o.y = o.y2;"),k.yc&&(i+=k.height?"\n  o.y = (o.yc - o.height/2);":"\n  o.y = o.yc;"),b(a,k)&&(i+="\n  item.touch();"),i+="\n  if (trans) trans.interpolate(item, o);";try{return Function("item","group","trans",i)}catch(l){E.error(l),E.log(i)}}function b(a,b){return b.path||("area"===a||"line"===a)&&(b.x||b.x2||b.width||b.y||b.y2||b.height||b.tension||b.interpolate)}function c(a,b){if(null==b)return null;var c="fill"===a||"stroke"===a;if(c){if(b.c)return d("hcl",b.h,b.c,b.l);if(b.h||b.s)return d("hsl",b.h,b.s,b.l);if(b.l||b.a)return d("lab",b.l,b.a,b.b);if(b.r||b.g||b.b)return d("rgb",b.r,b.g,b.b)}if(b.template)return E.parse.template.source(b.template,"item.datum");var f="item.datum.data";if(void 0!==b.value&&(f=E.str(b.value)),null!=b.group){var g="group.datum";E.isString(b.group)&&(g=e[b.group]?"group."+b.group:"group.datum["+E.field(b.group).map(E.str).join("][")+"]")}if(null!=b.field?E.isString(b.field)?(f="item.datum["+E.field(b.field).map(E.str).join("][")+"]",null!=b.group&&(f="this.accessor("+f+")("+g+")")):f="this.accessor(group.datum["+E.field(b.field.group).map(E.str).join("][")+"])(item.datum.data)":null!=b.group&&(f=g),null!=b.scale){var h=E.isString(b.scale)?E.str(b.scale):(b.scale.group?"group":"item")+".datum["+E.str(b.scale.group||b.scale.field)+"]";h="group.scales["+h+"]",f=h+(b.band?".rangeBand()":"("+f+")")}return f="("+(null!=b.mult?E.number(b.mult)+" * ":"")+f+")"+(b.offset?" + "+E.number(b.offset):"")}function d(a,b,d,e){var f=b?c("",b):E.config.color[a][0],g=d?c("",d):E.config.color[a][1],h=e?c("",e):E.config.color[a][2];return"(this.d3."+a+"("+[f,g,h].join(",")+') + "")'}var e={width:1,height:1,"mark.group.width":1,"mark.group.height":1};return a}(),E.parse.scales=function(){function b(a,b,d,e){return(a||[]).reduce(function(a,b){var f=b.name,g=f+":prev";return a[f]=c(b,a[f],d,e),a[g]=a[g]||a[f],a},b||{})}function c(a,b,c,g){if(b)return b;var h=d(a,b),i=h.type===l?e:f,k=j(a,g),m=E.values(g.datum);return i(a,h,k,c,m),h}function d(b,c){var d=b.type||k;if(!c||d!==c.type){var e=E.config.scale[d]||a.scale[d];e||E.error("Unrecognized scale type: "+d),(c=e()).type=c.type||d,c.scaleName=b.name}return c}function e(a,b,c,d,e){var f,i,j,k,l=!1,m=a.padding||0,n=null==a.outerPadding?m:a.outerPadding;if(E.isObject(a.range)&&!E.isArray(a.range)&&(l=!0,k=a.range.fields||E.array(a.range),c=g(k,d,e)),i=a.sort&&!l,f=h(a,d,e,i),f&&b.domain(f),a.bandWidth){var o=a.bandWidth,p=f.length,q=c[0]||0,r=a.points?m*o:m*o*(p-1)+2*n;c=[q,q+(o*p+r)]}j="string"==typeof c[0],j||c.length>2||1===c.length||l?b.range(c):a.points&&(a.round||null==a.round)?b.rangeRoundPoints(c,m):a.points?b.rangePoints(c,m):a.round||null==a.round?b.rangeRoundBands(c,m,n):b.rangeBands(c,m,n)}function f(b,c,d,e,f){var g,j;g=b.type===p?h(b,e,f,!1):i(b,e,f),c.domain(g),"height"===b.range&&(d=d.reverse()),c[b.round&&c.rangeRound?"rangeRound":"range"](d),b.exponent&&b.type===n&&c.exponent(b.exponent),b.clamp&&c.clamp(!0),b.nice&&(b.type===o?(j=a.time[b.nice],j||E.error("Unrecognized interval: "+j),c.nice(j)):c.nice())}function g(a,b,c){return a.reduce(function(a,d){var e=E.values(b[d.data]||c),f=E.accessor(E.isString(d.field)?d.field:"data."+E.accessor(d.field.group)(c));return E.unique(e,f,a)},[])}function h(a,b,c,d){var e,f,h=a.domain;return E.isArray(h)?e=d?h.slice():h:E.isObject(h)&&(f=h.fields||E.array(h),e=g(f,b,c)),e&&d&&e.sort(E.cmp),e}function i(b,c,d){function e(b,e,f,g){var i=E.values(c[b.data]||d),j=E.array(b.field).map(function(a){return E.isString(a)?a:"data."+E.accessor(a.group)(d)});j.forEach(function(b,c){b=E.accessor(b),e&&(h[0]=a.min([h[0],a.min(i,b)])),f&&(h[g]=a.max([h[g],a.max(i,b)]))})}var f,g,h=[null,null];return void 0!==b.domain&&(E.isArray(b.domain)?h=b.domain.slice():E.isObject(b.domain)?(f=b.domain.fields||E.array(b.domain),f.forEach(function(a){e(a,1,1,1)})):h=b.domain),g=h.length-1,void 0!==b.domainMin&&(E.isObject(b.domainMin)?(h[0]=null,f=b.domainMin.fields||E.array(b.domainMin),f.forEach(function(a){e(a,1,0,g)})):h[0]=b.domainMin),void 0!==b.domainMax&&(E.isObject(b.domainMax)?(h[g]=null,f=b.domainMax.fields||E.array(b.domainMax),f.forEach(function(a){e(a,0,1,g)})):h[g]=b.domainMax),b.type===m||b.type===o||!b.zero&&void 0!==b.zero||(h[0]=Math.min(0,h[0]),h[g]=Math.max(0,h[g])),h}function j(a,b){var c=[null,null];if(void 0!==a.range)if("string"==typeof a.range)if(q[a.range])c=[0,b[a.range]];else{if(!E.config.range[a.range])return E.error("Unrecogized range: "+a.range),c;c=E.config.range[a.range]}else if(E.isArray(a.range))c=E.duplicate(a.range);else{if(E.isObject(a.range))return null;c=[0,a.range]}if(void 0!==a.rangeMin&&(c[0]=a.rangeMin),void 0!==a.rangeMax&&(c[c.length-1]=a.rangeMax),void 0!==a.reverse){var d=a.reverse;E.isObject(d)&&(d=E.accessor(d.field)(b.datum)),d&&(c=c.reverse())}return c}var k="linear",l="ordinal",m="log",n="pow",o="time",p="quantile",q={width:1,height:1};return b}(),E.parse.spec=function(b,c,d){function e(a){a=E.duplicate(a);var b=a.width||500,e=a.height||500,f=a.viewport||null,g={width:b,height:e,viewport:f,background:E.parse.background(a.background),padding:E.parse.padding(a.padding),marks:E.parse.marks(a,b,e),data:E.parse.data(a.data,function(){c(h)})},h=d(g)}d=d||E.ViewFactory,E.isObject(b)?e(b):a.json(b,function(a,b){a?E.error(a):e(b)})},E.parse.template=function(a){var b=E.parse.template.source(a,"d");b="var __t; return "+b+";";try{return new Function("d",b).bind(E)}catch(c){throw c.source=b,c}},E.parse.template.source=function(a,b){b=b||"obj";var c=0,d="'",e=O;return a.replace(e,function(e,f,g){return d+=a.slice(c,g).replace(Q,R),c=g+e.length,f&&(d+="'\n+((__t=("+N(f,b)+"))==null?'':__t)+\n'"),e}),d+"'"};var N=function(b,c){function d(a){return a=a||"",g?(g=!1,h="String("+h+")"+a):h+=a,h}var e=b.split("|"),f=e.shift().trim(),g=!0,h=E.field(f).map(E.str).join("][");h=c+"["+h+"]";for(var i=0;i<e.length;++i){var j,k,l,m=e[i],n=null;switch((j=m.indexOf(":"))>0&&(m=m.slice(0,j),n=e[i].slice(j+1).split(",").map(function(a){return a.trim()})),m=m.trim()){case"length":d(".length");break;case"lower":d(".toLowerCase()");break;case"upper":d(".toUpperCase()");break;case"lower-locale":d(".toLocaleLowerCase()");break;case"upper-locale":d(".toLocaleUpperCase()");break;case"trim":d(".trim()");break;case"left":k=E.number(n[0]),d(".slice(0,"+k+")");break;case"right":k=E.number(n[0]),d(".slice(-"+k+")");break;case"mid":k=E.number(n[0]),l=k+E.number(n[1]),d(".slice(+"+k+","+l+")");break;case"slice":k=E.number(n[0]),d(".slice("+k+(n.length>1?","+E.number(n[1]):"")+")");break;case"truncate":k=E.number(n[0]),l=n[1],l="left"!==l&&"middle"!==l&&"center"!==l?"right":l,h="this.truncate("+d()+","+k+',"'+l+'")';break;case"number":k=U(n[0],a.format),g=!1,h="this.__formats["+k+"]("+h+")";break;case"time":k=U(n[0],a.time.format),g=!1,h="this.__formats["+k+"]("+h+")";break;default:throw Error("Unrecognized template filter: "+m)}}return h},O=/\{\{(.+?)\}\}|$/g,P={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Q=/\\|'|\r|\n|\u2028|\u2029/g,R=function(a){return"\\"+P[a]},S=[],T={},U=function(a,b){if(!("'"===a[0]&&"'"===a[a.length-1]||'"'!==a[0]&&'"'===a[a.length-1]))throw Error("Format pattern must be quoted: "+a);if(a=a.slice(1,-1),!T[a]){var c=b(a),d=S.length;S.push(c),T[a]=d}return T[a]};E.__formats=S,E.parse.transform=function(a){var b=E.data[a.type]();return E.keys(a).forEach(function(c){"type"!==c&&b[c](a[c])}),b},E.scene={},E.scene.GROUP="group",E.scene.ENTER=0,E.scene.UPDATE=1,E.scene.EXIT=2,E.scene.DEFAULT_DATA={sentinel:1},E.scene.data=function(a,b){var c=E.scene.DEFAULT_DATA;return a=E.values(a||b||[c]),a===c&&(a=[c]),a},E.scene.fontString=function(a){return(a.fontStyle?a.fontStyle+" ":"")+(a.fontVariant?a.fontVariant+" ":"")+(a.fontWeight?a.fontWeight+" ":"")+(null!=a.fontSize?a.fontSize:E.config.render.fontSize)+"px "+(a.font||E.config.render.font)},E.scene.Item=function(){function a(a){this.mark=a}var b=a.prototype;return b.hasPropertySet=function(a){var b=this.mark.def.properties;return b&&null!=b[a]},b.cousin=function(a,b){if(0===a)return this;a=a||-1;var c=this.mark,d=c.group,e=null==b?c.items.indexOf(this):b,f=d.items.indexOf(c)+a;return d.items[f].items[e]},b.sibling=function(a){if(0===a)return this;a=a||-1;var b=this.mark,c=b.items.indexOf(this)+a;return b.items[c]},b.remove=function(){var a=this,b=a.mark.items,c=b.indexOf(a);return c>=0&&(c===b.length-1?b.pop():b.splice(c,1)),a},b.touch=function(){this.pathCache&&(this.pathCache=null),this.mark.pathCache&&(this.mark.pathCache=null)},a}(),E.scene.item=function(a){return new E.scene.Item(a)},E.scene.visit=function(a,b){var c,d,e,f,g;if(b(a))return!0;var h=["items","axisItems","legendItems"];for(e=0,f=h.length;f>e;++e)if(g=a[h[e]])for(c=0,d=g.length;d>c;++c)if(E.scene.visit(g[c],b))return!0},E.scene.build=function(){function b(a,b,g,i,j){var k=E.scene.data(a.from?a.from(b,g,i):null,i);return g=c(a,g),g.items=d(a,k,g),f(a,g),a.type===h&&e(a,b,g,j),g}function c(a,b){return b=b||{},b.def=a,b.marktype=a.type,b.interactive=!(a.interactive===!1),b}function d(a,b,c){var d,e,f,h,l,m,n=g(a.key),o=c.items||[],p=[],q={};for(d=0,f=o.length;f>d;++d)h=o[d],h.status=k,n&&(q[h.key]=h);for(d=0,f=b.length;f>d;++d)l=b[d],e=d,h=n?q[e=n(l)]:o[d],m=h?!1:(h=E.scene.item(c),!0),h.status=m?i:j,h.datum=l,h.key=e,p.push(h);for(d=0,f=o.length;f>d;++d)h=o[d],h.status===k&&(h.key=n?h.key:p.length,p.splice(h.index,0,h));return p}function e(a,c,d,e){var f,g,h,i,j,k,l=d.items,m=a.marks;for(f=0,g=l.length;g>f;++f){if(k=l[f],!e&&k.scales)for(j in k.scales)j.indexOf(":prev")<0&&(k.scales[j+":prev"]=k.scales[j].copy());for(k.items=k.items||[],h=0,i=m.length;i>h;++h)k.items[h]=b(m[h],c,k.items[h],k.datum),k.items[h].group=k}}function f(b,c){if(b.duration&&(c.duration=b.duration),b.ease&&(c.ease=a.ease(b.ease)),b.delay){var d,e=c.items,f=c.group,g=e.length;for(d=0;g>d;++d)b.delay.call(this,e[d],f)}}function g(a){if(null==a)return null;var b=E.array(a).map(E.accessor);return function(a){for(var c="",d=0,e=b.length;e>d;++d)d>0&&(c+="|"),c+=String(b[d](a));return c}}var h=E.scene.GROUP,i=E.scene.ENTER,j=E.scene.UPDATE,k=E.scene.EXIT;return b}(),E.scene.bounds=function(){function b(){return w||(w=(E.config.isNode?new(require("canvas"))(1,1):a.select("body").append("canvas").attr("class","vega_hidden").attr("width",1).attr("height",1).style("display","none").node()).getContext("2d"))}function c(a,b,c){return null==b?c.set(0,0,0,0):(q(b,c),a.stroke&&0!==a.opacity&&a.strokeWidth>0&&c.expand(a.strokeWidth)),c}function d(a,b){var d=a.path?a.pathCache||(a.pathCache=p(a.path)):null;return c(a,d,b)}function e(a,b){var d=a.mark.items,a=d[0],e=a.pathCache||(a.pathCache=p(r(d)));return c(d[0],e,b)}function f(a,b){var d=a.mark.items,a=d[0],e=a.pathCache||(a.pathCache=p(s(d)));return c(d[0],e,b)}function g(a,b){var c=a.x||0,d=a.y||0,e=c+a.width||0,f=d+a.height||0;return b.set(c,d,e,f),a.stroke&&0!==a.opacity&&a.strokeWidth>0&&b.expand(a.strokeWidth),b}function h(a,b){var c=a.width||0,d=a.height||0,e=(a.x||0)-("center"===a.align?c/2:"right"===a.align?c:0),f=(a.y||0)-("middle"===a.baseline?d/2:"bottom"===a.baseline?d:0);return b.set(e,f,e+c,f+d)}function i(a,b){var c,d;return b.set(c=a.x||0,d=a.y||0,null!=a.x2?a.x2:c,null!=a.y2?a.y2:d),a.stroke&&0!==a.opacity&&a.strokeWidth>0&&b.expand(a.strokeWidth),b}function j(a,b){var c,d,e,f,g,h,i,j,k,l=a.x||0,m=a.y||0,n=a.innerRadius||0,o=a.outerRadius||0,p=(a.startAngle||0)-t,q=(a.endAngle||0)-t,r=1/0,s=-(1/0),u=1/0,v=-(1/0),w=[p,q],x=p-p%t;for(d=0;4>d&&q>x;++d,x+=t)w.push(x);for(d=0,e=w.length;e>d;++d)c=w[d],f=Math.cos(c),h=n*f,j=o*f,g=Math.sin(c),i=n*g,k=o*g,r=Math.min(r,h,j),s=Math.max(s,h,j),u=Math.min(u,i,k),v=Math.max(v,i,k);return b.set(l+r,m+u,l+s,m+v),a.stroke&&0!==a.opacity&&a.strokeWidth>0&&b.expand(a.strokeWidth),b}function k(a,b){var c,d,e,f,g=null!=a.size?a.size:100,h=a.x||0,i=a.y||0;switch(a.shape){case"cross":c=Math.sqrt(g/5)/2,d=3*c,b.set(h-d,i-c,h+d,i+c);break;case"diamond":f=Math.sqrt(g/(2*v)),e=f*v,b.set(h-e,i-f,h+e,i+f);break;case"square":d=Math.sqrt(g),c=d/2,b.set(h-c,i-c,h+c,i+c);break;case"triangle-down":e=Math.sqrt(g/u),f=e*u/2,b.set(h-e,i-f,h+e,i+f);break;case"triangle-up":e=Math.sqrt(g/u),f=e*u/2,b.set(h-e,i-f,h+e,i+f);break;default:c=Math.sqrt(g/Math.PI),b.set(h-c,i-c,h+c,i+c)}return a.stroke&&0!==a.opacity&&a.strokeWidth>0&&b.expand(a.strokeWidth),b}function l(a,c,d){var e,f,g=(a.x||0)+(a.dx||0),h=(a.y||0)+(a.dy||0),i=a.fontSize||E.config.render.fontSize,j=a.align,k=a.baseline,l=a.radius||0,m=b();return m.font=E.scene.fontString(a),m.textAlign=j||"left",m.textBaseline=k||"alphabetic",e=m.measureText(a.text||"").width,l&&(f=(a.theta||0)-Math.PI/2,g+=l*Math.cos(f),h+=l*Math.sin(f)),"center"===j?g-=e/2:"right"===j&&(g-=e),"top"===k?h+=i/5:"bottom"===k?h-=i:"middle"===k?h=h-i/2+i/10:h-=4*i/5,c.set(g,h,g+e,h+i),a.angle&&!d&&c.rotate(a.angle*Math.PI/180,a.x||0,a.y||0),c.expand(d?0:1)}function m(a,b,c){var d,e,f=a.axisItems||[],g=a.legendItems||[];for(d=0,e=f.length;e>d;++d)b.union(f[d].bounds);for(d=0,e=a.items.length;e>d;++d)b.union(a.items[d].bounds);if(c){for(d=0,e=g.length;e>d;++d)b.union(g[d].bounds);null!=a.width&&null!=a.height&&b.add(a.width,a.height),null!=a.x&&null!=a.y&&b.add(0,0)}return b.translate(a.x||0,a.y||0),b}function n(a,b,c){b=b||x[a.mark.marktype],a.bounds_prev||(a["bounds:prev"]=new E.Bounds);var d=a.bounds,e=a["bounds:prev"];return d&&e.clear().union(d),a.bounds=b(a,d?d.clear():new E.Bounds,c),d||e.clear().union(a.bounds),a.bounds}function o(a,b,c){b=b||a.bounds&&a.bounds.clear()||new E.Bounds;var d,e,f=a.marktype,g=x[f],h=a.items;if("area"===f||"line"===f)h.length&&(h[0].bounds=g(h[0],b));else for(d=0,e=h.length;e>d;++d)b.union(n(h[d],g,c));a.bounds=b}var p=E.canvas.path.parse,q=E.canvas.path.bounds,r=E.canvas.path.area,s=E.canvas.path.line,t=Math.PI/2,u=Math.sqrt(3),v=Math.tan(30*Math.PI/180),w=null,x={group:m,symbol:k,image:h,rect:g,rule:i,arc:j,text:l,path:d,area:e,line:f};return{mark:o,item:n,text:l,group:m}}(),E.scene.encode=function(){function a(a,d,e,f,g,h){return f&&g?b.call(this,a,d,e,f,g,h):c.call(this,a,a,d,e,f,h),a}function b(a,b,c,d,e){e=E.array(e);var f,g,h,i,j,k;for(f=0,g=e.length;g>f;++f)h=e[f],i=h.mark.group||null,j=h.mark.def.properties,k=j&&j[d],k&&(k.call(E,h,i,c),E.scene.bounds.item(h))}function c(a,b,c,d,h,i){f.call(this,a,b.items,c,d,h,i),b.marktype===g?e.call(this,b,c,a,d,h,i):E.scene.bounds.mark(b)}function d(a,b,c,d,g,h){e.call(this,b,c,a,d,g,h),f.call(this,a,b.items,c,d,g),E.scene.bounds.mark(b,null,!0)}function e(a,b,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t;for(i=0,j=a.items.length;j>i;++i)for(m=a.items[i],n=m.scales||(m.scales=b.scales?E.extend({},e.scales):e.scales),b.scales&&E.parse.scales(b.scales,n,this._data,m),b.axes&&(o=m.axes||(m.axes=[]),p=m.axisItems||(m.axisItems=[]),E.parse.axes(b.axes,o,m.scales),o.forEach(function(a,b){q=a.def(),p[b]=E.scene.build(q,this._data,p[b],null,1),p[b].group=m,c.call(this,m,m.axisItems[b],q,f)})),k=0,l=m.items.length;l>k;++k)c.call(this,m,m.items[k],b.marks[k],f,g);if(E.scene.bounds.mark(a,null,!b.legends),h!==!1&&b.legends){for(i=0,j=a.items.length;j>i;++i)m=a.items[i],r=m.legends||(m.legends=[]),s=m.legendItems||(m.legendItems=[]),E.parse.legends(b.legends,r,m.scales),r.forEach(function(a,b){t=a.def(),s[b]=E.scene.build(t,this._data,s[b],null,1),s[b].group=m,d.call(this,m,m.legendItems[b],t,f)});E.scene.bounds.mark(a,null,!0)}}function f(a,b,c,d,e){var f,g,l,m,n=c.properties||k,o=n.enter,p=n.update,q=n.exit;if(e){if(m=n[e])for(f=0,g=b.length;g>f;++f)m.call(E,b[f],a,d)}else for(f=0;f<b.length;++f)l=b[f],l.status===h&&(o&&o.call(E,l,a),l.status=i),l.status!==j&&p&&p.call(E,l,a,d),l.status===j&&(q&&q.call(E,l,a,d),d&&!q?d.interpolate(l,k):d||b[f--].remove())}var g=E.scene.GROUP,h=E.scene.ENTER,i=E.scene.UPDATE,j=E.scene.EXIT,k={};return a}(),E.scene.Transition=function(){function b(b,c){this.duration=b||500,this.ease=c&&a.ease(c)||a.ease("cubic-in-out"),this.updates={next:null}}function c(a){for(var b,c,d,e,f,g,h=this.updates,i=h,j=i.next,k=this.duration,l=!0;null!=j;i=j,j=i.next)if(b=j.item,c=b.delay||0,d=(a-c)/k,0>d)l=!1;else{for(d>1&&(d=1),e=j.ease(d),f=0,g=j.length;g>f;++f)b[j[f].property]=j[f](e);b.touch(),E.scene.bounds.item(b),1===d?(j.remove&&b.remove(),i.next=j.next,j=i):l=!1}return this.callback(),l}var d=b.prototype,e={text:1,url:1};return d.interpolate=function(b,c){var d,f,g,h,i=null;for(d in c)f=b[d],g=c[d],f!==g&&(e[d]||void 0===f?b[d]=g:"number"!=typeof f||isFinite(f)?(h=a.interpolate(f,g),h.property=d,(i||(i=[])).push(h)):b[d]=g);return null===i&&b.status===E.scene.EXIT&&(i=[]),null!=i&&(i.item=b,i.ease=b.mark.ease||this.ease,i.next=this.updates.next,this.updates.next=i),this},d.start=function(b){for(var d=this,e=d.updates,f=e.next;null!=f;e=f,f=e.next)f.item.status===E.scene.EXIT&&(f.remove=!0);d.callback=b,a.timer(function(a){return c.call(d,a)})},b}(),E.scene.transition=function(a,b){return new E.scene.Transition(a,b)},E.scene.axis=function(){function b(){k=null}function c(){return F||("log"===g.type?".1s":null)}function d(){var b=c();return g.tickFormat?g.tickFormat(H,b):b?"time"===g.type?a.time.format(b):a.format(b):String}function e(a){var b={major:D,minor:null};return null==b.major&&(b.major=g.ticks?g.ticks(H):g.domain()),b.minor=l(g,b.major,G).map(E.data.ingest),b.major=b.major.map(function(b){return b=E.data.ingest(b),b.label=a(b.data),b}),b}function f(a){var b,c,d;"ordinal"===a.type?(b={scale:a.scaleName,offset:.5+a.rangeBand()/2},c=b):(b={scale:a.scaleName,offset:.5},c={scale:a.scaleName+":prev",offset:.5}),d=n(a);var e=t(),f=t(),g=t(),i=u(),k=w(),l=v();e.properties.enter.stroke={value:E.config.axis.gridColor},p(h,e,c,b,1/0),p(h,f,c,b,z),p(h,g,c,b,A),o(h,i,c,b,z,C),r(h,k,d,B),q(h,l,d,j),E.extend(e.properties.update,I),E.extend(f.properties.update,K),E.extend(g.properties.update,L),E.extend(i.properties.update,J),E.extend(k.properties.update,N),E.extend(l.properties.update,M);var m=[e,f,g,i,k,l];return{type:"group",interactive:!1,properties:{enter:s,update:s},marks:m.map(E.parse.mark)}}var g,h=E.config.axis.orient,i=0,j=E.config.axis.titleOffset,k=null,m="front",x=!1,y=null,z=E.config.axis.tickSize,A=E.config.axis.tickSize,B=E.config.axis.tickSize,C=E.config.axis.padding,D=null,F=null,G=0,H=E.config.axis.ticks,I={},J={},K={},L={},M={},N={},O={};return O.def=function(){var a=k?k:k=f(g),b=d(),c=e(b),j=y?[y].map(E.data.ingest):[];return a.marks[0].from=function(){return x?c.major:[]},a.marks[1].from=function(){return c.major},a.marks[2].from=function(){return c.minor},a.marks[3].from=a.marks[1].from,a.marks[4].from=function(){return[1]},a.marks[5].from=function(){return j},a.offset=i,a.orient=h,a.layer=m,a},O.scale=function(a){return arguments.length?(g!==a&&(g=a,b()),O):g},O.orient=function(a){return arguments.length?(h!==a&&(h=a in V?a+"":E.config.axis.orient,b()),O):h},O.title=function(a){return arguments.length?(y!==a&&(y=a,b()),O):y},O.tickCount=function(a){return arguments.length?(H=a,O):H},O.tickValues=function(a){return arguments.length?(D=a,O):D},O.tickFormat=function(a){return arguments.length?(F!==a&&(F=a,b()),O):F},O.tickSize=function(a,c){if(!arguments.length)return z;var d=arguments.length-1,e=+a,f=d>1?+c:z,g=d>0?+arguments[d]:z;return(z!==e||A!==f||B!==g)&&b(),z=e,A=f,B=g,O},O.tickSubdivide=function(a){return arguments.length?(G=+a,O):G},O.offset=function(a){return arguments.length?(i=E.isObject(a)?a:+a,O):i},O.tickPadding=function(a){return arguments.length?(C!==+a&&(C=+a,b()),O):C},O.titleOffset=function(a){return arguments.length?(j!==+a&&(j=+a,b()),O):j},O.layer=function(a){return arguments.length?(m!==a&&(m=a,b()),O):m},O.grid=function(a){return arguments.length?(x!==a&&(x=a,b()),O):x},O.gridLineProperties=function(a){return arguments.length?(I!==a&&(I=a),O):I},O.majorTickProperties=function(a){return arguments.length?(K!==a&&(K=a),O):K},O.minorTickProperties=function(a){return arguments.length?(L!==a&&(L=a),O):L},O.tickLabelProperties=function(a){return arguments.length?(J!==a&&(J=a),O):J},O.titleProperties=function(a){return arguments.length?(M!==a&&(M=a),O):M},O.domainProperties=function(a){return arguments.length?(N!==a&&(N=a),O):N},O.reset=function(){b()},O};var V={top:1,right:1,bottom:1,left:1},W={bottom:"center",top:"center",left:"right",right:"left"},X={bottom:"top",top:"bottom",left:"middle",right:"middle"};E.scene.legend=function(){function b(){h=null}function c(a){return"ordinal"===a||"quantize"===a||"quantile"===a||"threshold"===a}function d(b){var c,d,f,g=e(i,j,k,l),h=(null==n?b.ticks?b.ticks.apply(b,u):b.domain():n).map(E.data.ingest),p=null==o?b.tickFormat?b.tickFormat.apply(b,u):String:o,r=5,s=a.range(h.length);i?(d=h.map(function(a){return Math.sqrt(i(a.data))}),f=a.max(d),d=d.reduce(function(a,b,c,d){return c>0&&(a[c]=a[c-1]+d[c-1]/2+r),a[c]+=b/2,a},[0]).map(Math.round)):(f=Math.round(Math.sqrt(E.config.legend.symbolSize)),d=m||(c=H.fontSize)&&c.value+r||E.config.legend.labelFontSize+r,d=s.map(function(a,b){return Math.round(f/2+b*d)}));var v,w=t;q&&(v=G.fontSize,w+=5+(v&&v.value||E.config.legend.titleFontSize));for(var x=0,y=d.length;y>x;++x)d[x]+=w;var b={name:"legend",type:"ordinal",points:!0,domain:s,range:d},z=(q?[q]:[]).map(E.data.ingest);return h.forEach(function(a){a.label=p(a.data),a.offset=f}),g.scales=[b],g.marks[0].from=function(){return z},g.marks[1].from=function(){return h},g.marks[2].from=g.marks[1].from,g}function e(a,b,c,d){var e=z(),f=A(),g=B();return y(f,a,b,c,d),E.extend(e.properties.update,G),E.extend(f.properties.update,w),E.extend(g.properties.update,H),e.properties.enter.x.value+=t,e.properties.enter.y.value+=t,g.properties.enter.x.offset+=t+1,f.properties.enter.x.offset=t+1,g.properties.update.x.offset+=t+1,f.properties.update.x.offset=t+1,{type:"group",interactive:!1,properties:{enter:E.parse.properties("group",v),update:x},marks:[e,f,g].map(E.parse.mark)}}function f(a){var b=g(a),c=a.domain(),d=c.map(E.data.ingest),e=F.width&&F.width.value||E.config.legend.gradientWidth,f=null==o?a.tickFormat?a.tickFormat.apply(a,u):String:o,h={name:"legend",type:a.type,round:!0,zero:!1,domain:[c[0],c[c.length-1]],range:[t,e+t]};"pow"===a.type&&(h.exponent=a.exponent());var i=(q?[q]:[]).map(E.data.ingest);return d.forEach(function(a,b){a.label=f(a.data),a.align=b==d.length-1?"right":0==b?"left":"center"}),b.scales=[h],b.marks[0].from=function(){return i},b.marks[1].from=function(){return[1]},b.marks[2].from=function(){return d},b}function g(a){var b=z(),c=C(),d=D(),e=new E.Gradient,f=a.domain(),g=f[0],h=f[f.length-1],i=a.copy().domain([g,h]).range([0,1]),j="linear"!==a.type&&a.ticks?a.ticks.call(a,15):f;g!==j[0]&&j.unshift(g),h!==j[j.length-1]&&j.push(h);for(var k=0,l=j.length;l>k;++k)e.stop(i(j[k]),a(j[k]));c.properties.enter.fill={value:e},E.extend(b.properties.update,G),E.extend(c.properties.update,F),E.extend(d.properties.update,H);var m=c.properties,n=F.height,o=n&&n.value||m.enter.height.value;if(d.properties.enter.y.value=o,d.properties.update.y.value=o,q){var p=b.properties,r=G.fontSize,s=4+(r&&r.value||p.enter.fontSize.value);c.properties.enter.y.value+=s,d.properties.enter.y.value+=s,c.properties.update.y.value+=s,d.properties.update.y.value+=s}return b.properties.enter.x.value+=t,b.properties.enter.y.value+=t,c.properties.enter.x.value+=t,c.properties.enter.y.value+=t,d.properties.enter.y.value+=t,c.properties.update.x.value+=t,c.properties.update.y.value+=t,d.properties.update.y.value+=t,{type:"group",interactive:!1,properties:{enter:E.parse.properties("group",v),update:x},marks:[b,c,d].map(E.parse.mark)}}var h,i=null,j=null,k=null,l=null,m=null,n=null,o=null,p=null,q=void 0,r="right",s=E.config.legend.offset,t=E.config.legend.padding,u=[5],v={},w={},F={},G={},H={},I={},h=null;return I.def=function(){var b=i||j||k||l;return o=p?"time"===b.type?a.time.format(p):a.format(p):null,h||(h=b!==k&&b!==l||c(b.type)?d(b):f(b)),h.orient=r,h.offset=s,h.padding=t,h},I.size=function(a){return arguments.length?(i!==a&&(i=a,b()),I):i},I.shape=function(a){return arguments.length?(j!==a&&(j=a,b()),I):j},I.fill=function(a){return arguments.length?(k!==a&&(k=a,b()),I):k},I.stroke=function(a){return arguments.length?(l!==a&&(l=a,b()),I):l},I.title=function(a){return arguments.length?(q!==a&&(q=a,b()),I):q},I.format=function(a){return arguments.length?(p!==a&&(p=a,b()),I):p},I.spacing=function(a){return arguments.length?(m!==+a&&(m=+a,b()),I):m},I.orient=function(a){return arguments.length?(r=a in Y?a+"":E.config.legend.orient,I):r},I.offset=function(a){return arguments.length?(s=+a,I):s},I.values=function(a){return arguments.length?(n=a,I):n},I.legendProperties=function(a){return arguments.length?(v=a,I):v},I.symbolProperties=function(a){return arguments.length?(w=a,I):w},I.gradientProperties=function(a){return arguments.length?(F=a,I):F},I.labelProperties=function(a){return arguments.length?(H=a,I):H},I.titleProperties=function(a){return arguments.length?(G=a,I):G},I.reset=function(){b()},I};var Y={right:1,left:1};return E.Model=function(){function a(){this._defs=null,this._data={},this._scene=null,this._reset={axes:!1,legends:!1}}var b=a.prototype;return b.defs=function(a){return arguments.length?(this._defs=a,this):this._defs},b.data=function(a){function b(a){(i[a]||[]).forEach(function(c){f[c]=a,b(c)})}if(!arguments.length)return this._data;var c,d,e,f={},g=this._defs,i=g.data.source,j=g.data.flow||{},l=g.data.sorted,m=l.length;for(E.keys(a).forEach(b),c=0;m>c;++c){if(a[d=l[c]])e=a[d];else{if(!f[d])continue;e=k(this._data[f[d]]),E.isTree(a)&&h(e)}this._data[d]=j[d]?j[d](e,this._data,g.marks):e}return this._reset.legends=!0,this},b.width=function(a){return this._defs&&(this._defs.width=a),this._defs&&this._defs.marks&&(this._defs.marks.width=a),this._scene&&(this._scene.items[0].width=a),this._reset.axes=!0,this},b.height=function(a){return this._defs&&(this._defs.height=a),this._defs&&this._defs.marks&&(this._defs.marks.height=a),this._scene&&(this._scene.items[0].height=a),this._reset.axes=!0,this},b.scene=function(a){return arguments.length?(this._scene=a,this):this._scene},b.build=function(){var a=this,b=a._data,c=a._defs.marks;return a._scene=E.scene.build.call(a,c,b,a._scene),a._scene.items[0].width=c.width,a._scene.items[0].height=c.height,a._scene.interactive=!1,this},b.encode=function(a,b,c,d){this.reset();var e=this,f=e._scene,g=e._defs;return E.scene.encode.call(e,f,g.marks,a,b,c,d),this},b.reset=function(){return this._scene&&this._reset.axes&&(E.scene.visit(this._scene,function(a){a.axes&&a.axes.forEach(function(a){a.reset()})}),this._reset.axes=!1),this._scene&&this._reset.legends&&(E.scene.visit(this._scene,function(a){a.legends&&a.legends.forEach(function(a){a.reset()})}),this._reset.legends=!1),this},a}(),E.View=function(){var b=function(a,b,c){this._el=null,this._build=!1,this._model=new E.Model,this._width=this.__width=b||500,this._height=this.__height=c||500,this._bgcolor=null,this._autopad=1,this._padding={top:0,left:0,bottom:0,right:0},this._viewport=null,this._renderer=null,this._handler=null,
this._io=E.canvas,a&&this.initialize(a)},c=b.prototype;return c.width=function(a){return arguments.length?(this.__width!==a&&(this._width=this.__width=a,this._el&&this.initialize(this._el.parentNode),this._model.width(a),this._strict&&(this._autopad=1)),this):this.__width},c.height=function(a){return arguments.length?(this.__height!==a&&(this._height=this.__height=a,this._el&&this.initialize(this._el.parentNode),this._model.height(this._height),this._strict&&(this._autopad=1)),this):this.__height},c.background=function(a){return arguments.length?(this._bgcolor!==a&&(this._bgcolor=a,this._el&&this.initialize(this._el.parentNode)),this):this._bgcolor},c.padding=function(a){return arguments.length?(this._padding!==a&&(E.isString(a)?(this._autopad=1,this._padding={top:0,left:0,bottom:0,right:0},this._strict="strict"===a):(this._autopad=0,this._padding=a,this._strict=!1),this._el&&(this._renderer.resize(this._width,this._height,a),this._handler.padding(a))),this):this._padding},c.autopad=function(a){if(this._autopad<1)return this;this._autopad=0;var b=this._padding,c=this.model().scene().bounds,d=E.config.autopadInset,e=c.x1<0?Math.ceil(-c.x1)+d:0,f=c.y1<0?Math.ceil(-c.y1)+d:0,g=c.x2>this._width?Math.ceil(+c.x2-this._width)+d:0,c=c.y2>this._height?Math.ceil(+c.y2-this._height)+d:0;return b={left:e,top:f,right:g,bottom:c},this._strict?(this._autopad=0,this._padding=b,this._width=Math.max(0,this.__width-(e+g)),this._height=Math.max(0,this.__height-(f+c)),this._model.width(this._width),this._model.height(this._height),this._el&&this.initialize(this._el.parentNode),this.update({props:"enter"}).update({props:"update"})):this.padding(b).update(a),this},c.viewport=function(a){return arguments.length?(this._viewport!==a&&(this._viewport=a,this._el&&this.initialize(this._el.parentNode)),this):this._viewport},c.renderer=function(a){return arguments.length?("canvas"===a&&(a=E.canvas),"svg"===a&&(a=E.svg),this._io!==a&&(this._io=a,this._renderer=null,this._el&&this.initialize(this._el.parentNode),this._build&&this.render()),this):this._io},c.defs=function(a){return arguments.length?(this._model.defs(a),this):this._model.defs()},c.data=function(a){if(!arguments.length)return this._model.data();var b=E.keys(a).reduce(function(b,c){return b[c]=E.data.ingestAll(a[c]),b},{});return this._model.data(b),this._build=!1,this},c.model=function(a){return arguments.length?(this._model!==a&&(this._model=a,this._handler&&this._handler.model(a)),this):this._model},c.initialize=function(b){var c,d=this,e=d._width,f=d._height,g=d._bgcolor,h=d._padding;return a.select(b).select("div.vega").remove(),this._el=b=a.select(b).append("div").attr("class","vega").style("position","relative").node(),d._viewport&&a.select(b).style("width",(d._viewport[0]||e)+"px").style("height",(d._viewport[1]||f)+"px").style("overflow","auto"),d._renderer=(d._renderer||new this._io.Renderer).initialize(b,e,f,h,g),c=d._handler,d._handler=(new this._io.Handler).initialize(b,h,d).model(d._model),c&&c.handlers().forEach(function(a){d._handler.on(a.type,a.handler)}),this},c.render=function(a){return this._renderer.render(this._model.scene(),a),this},c.on=function(){return this._handler.on.apply(this._handler,arguments),this},c.off=function(){return this._handler.off.apply(this._handler,arguments),this},c.update=function(a){a=a||{};var b=this,c=a.duration?E.scene.transition(a.duration,a.ease):null;return b._build=b._build||(b._model.build(),!0),b._model.encode(c,a.props,a.items,a.legend),c?c.start(function(a){b._renderer.render(b._model.scene(),a)}):b.render(a.items),b.autopad(a)},b}(),E.ViewFactory=function(a){return function(b){b=b||{};var c=(new E.View).width(a.width).height(a.height).background(a.background).padding(a.padding).viewport(a.viewport).renderer(b.renderer||"canvas").defs(a);return a.data.load&&c.data(a.data.load),b.data&&c.data(b.data),b.el&&c.initialize(b.el),b.hover!==!1&&c.on("mouseover",function(a,b){b.hasPropertySet("hover")&&this.update({props:"hover",items:b})}).on("mouseout",function(a,b){b.hasPropertySet("hover")&&this.update({props:"update",items:b})}),c}},E.Spec=function(){var a=function(a){this.spec={width:500,height:500,padding:0,data:[],scales:[],axes:[],marks:[]},a&&E.extend(this.spec,a)},b=a.prototype;return b.width=function(a){return this.spec.width=a,this},b.height=function(a){return this.spec.height=a,this},b.padding=function(a){return this.spec.padding=a,this},b.viewport=function(a){return this.spec.viewport=a,this},b.data=function(a,b){return b?b.name=a:b=E.isString(a)?{name:a}:a,this.spec.data.push(b),this},b.scale=function(a,b){return b?b.name=a:b=E.isString(a)?{name:a}:a,this.spec.scales.push(b),this},b.axis=function(a){return this.spec.axes.push(a),this},b.mark=function(a,b){b?b.type=a:b={type:a},b.properties={},this.spec.marks.push(b);var c=this;return{from:function(a,c){return b.from=c?(c.data=a,c):E.isString(a)?{data:a}:a,this},prop:function(a,c){return b.properties[a]=E.keys(c).reduce(function(a,b){var d=c[b];return a[b]=E.isObject(d)?d:{value:d},a},{}),this},done:function(){return c}}},b.parse=function(a){E.parse.spec(this.spec,a)},b.json=function(){return this.spec},a}(),E.spec=function(a){return new E.Spec(a)},E.headless={},E.headless.canvas=E.canvas.Renderer,E.headless.svg=function(){function b(a,b,c){var d="<"+a;if(b)for(var e in b){var f=b[e];null!=f&&(d+=" "+e+'="'+f+'"')}return c&&(d+=" "+c),d+">"}function c(a){return"</"+a+">"}function d(a){return a=null==a?"":String(a),a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function e(a){return String(a).replace(/\"/g,"'")}function f(a){var d=a.width||0,e=a.height||0;return 0===d&&0===e?"":b("rect",{"class":"background",width:d,height:e},x(a,"rect"))+c("rect")}function g(a,b){var c=a.x||0,d=a.y||0,e={transform:"translate("+c+","+d+")"};if(a.clip){var f={width:a.width||0,height:a.height||0},g=a.clip_id||(a.clip_id="clip"+I++);b.clipping[g]=f,e["clip-path"]="url(#"+g+")"}return e}function h(a){var b=a.x||0,c=a.y||0;return{transform:"translate("+b+","+c+")",d:C(a)}}function i(a){if(a.length){var b=a[0],c="horizontal"===b.orient?F:D;return c.interpolate(b.interpolate||"linear").tension(null==b.tension?.7:b.tension),{d:c(a)}}}function j(a){if(a.length){var b=a[0];return G.interpolate(b.interpolate||"linear").tension(null==b.tension?.7:b.tension),{d:G(a)}}}function k(a){var b=a.x||0,c=a.y||0;return{transform:"translate("+b+","+c+")",d:a.path}}function l(a){return{x:a.x||0,y:a.y||0,width:a.width||0,height:a.height||0}}function m(a){var b=a.x||0,c=a.y||0;return{x1:b,y1:c,x2:null!=a.x2?a.x2:b,y2:null!=a.y2?a.y2:c}}function n(a){var b=a.x||0,c=a.y||0;return{transform:"translate("+b+","+c+")",d:H(a)}}function o(a){var b=a.width||a.image&&a.image.width||0,c=a.height||a.image&&a.image.height||0,d=a.x-("center"===a.align?b/2:"right"===a.align?b:0),e=a.y-("middle"===a.baseline?c/2:"bottom"===a.baseline?c:0),f=E.config.baseURL+a.url;return{"xlink:href":f,x:d,y:e,width:b,height:c}}function p(a){var b=a.x||0,c=a.y||0,d=a.dx||0,e=a.dy||0,f=a.angle||0,g=a.radius||0,h=J[a.align||"left"],i="top"===a.baseline?".9em":"middle"===a.baseline?".35em":0;if(g){var j=(a.theta||0)-Math.PI/2;b+=g*Math.cos(j),c+=g*Math.sin(j)}return{x:b+d,y:c+e,"text-anchor":h,transform:f?"rotate("+f+" "+b+","+c+")":null,dy:i?i:null}}function q(a){var b="type-"+a.type;return a.name&&(b+=" "+a.name),b}function r(a){return a.x||0}function s(a){return a.y||0}function t(a){return a.x+a.width||0}function u(a){return a.y+a.height||0}function v(a){return null==a.size?100:a.size}function w(a){return a.shape||"circle"}function x(a,b,c){var d,e,f,g,h,i=a.mark?a:a.length?a[0]:null;if(null===i)return null;var j="";for(d=0,e=L.length;e>d;++d)f=L[d],g=K[f],h=i[f],null==h?"fill"===g&&(j+="fill:none;"):(h.id&&(c.gradient[h.id]=h,h="url("+window.location.href+"#"+h.id+")"),j+=g+":"+h+";");return"text"===b&&(j+="font:"+y(i)),j.length?'style="'+j+'"':null}function y(a){var b=(a.fontStyle?a.fontStyle+" ":"")+(a.fontVariant?a.fontVariant+" ":"")+(a.fontWeight?a.fontWeight+" ":"")+(null!=a.fontSize?a.fontSize:E.config.render.fontSize)+"px "+(a.font&&e(a.font)||E.config.render.font);return b}var z=function(){this._text={head:"",root:"",foot:"",defs:"",body:""},this._defs={gradient:{},clipping:{}}},A=z.prototype;A.initialize=function(a,d,e,f,g){var h=this._text,i={width:d,height:e};null!=g&&(i.style="background-color:"+g+";"),h.head=b("svg",i,E.config.svgNamespace),h.root=b("g",{transform:"translate("+f.left+","+f.top+")"}),h.foot=c("g")+c("svg")},A.svg=function(){var a=this._text;return a.head+a.defs+a.root+a.body+a.foot},A.buildDefs=function(){var a,d,e=this._defs,f=E.keys(e.gradient),g=E.keys(e.clipping),h="";for(a=0;a<f.length;++a){var i=f[a],j=e.gradient[i],k=j.stops;for(h+=b("linearGradient",{id:i,x1:j.x1,x2:j.x2,y1:j.y1,y2:j.y2}),d=0;d<k.length;++d)h+=b("stop",{offset:k[d].offset,"stop-color":k[d].color})+c("stop");h+=c("linearGradient")}for(a=0;a<g.length;++a){var i=g[a],j=e.clipping[i];h+=b("clipPath",{id:i}),h+=b("rect",{x:0,y:0,width:j.width,height:j.height})+c("rect"),h+=c("clipPath")}return h},A.render=function(a){this._text.body=this.draw(a),this._text.defs=this.buildDefs()},A.draw=function(a){var e,f,g=B[a.marktype],h=g[0],i=g[1],j=g[2]||!1,k=j?[a.items]:a.items,l=this._defs,m="";for(m+=b("g",{"class":q(a.def)}),e=0;e<k.length;++e)f="g"===h?null:x(k[e],h,l),m+=b(h,i(k[e],l),f),"text"===h&&(m+=d(k[e].text)),"g"===h&&(m+=this.drawGroup(k[e])),m+=c(h);return m+c("g")};var B={group:["g",g],area:["path",i,!0],line:["path",j,!0],arc:["path",h],path:["path",k],symbol:["path",n],rect:["rect",l],rule:["line",m],text:["text",p],image:["image",o]};A.drawGroup=function(a){var b,c,d="",e=a.axisItems||[],g=a.items,h=a.legendItems||[];for(d+=f(a),b=0,c=e.length;c>b;++b)"back"===e[b].def.layer&&(d+=this.draw(e[b]));for(b=0,c=g.length;c>b;++b)d+=this.draw(g[b]);for(b=0,c=e.length;c>b;++b)"back"!==e[b].def.layer&&(d+=this.draw(e[b]));for(b=0,c=h.length;c>b;++b)d+=this.draw(h[b]);return d};var C=a.svg.arc(),D=a.svg.area().x(r).y1(s).y0(u),F=a.svg.area().y(s).x0(t).x1(r),G=a.svg.line().x(r).y(s),H=a.svg.symbol().type(w).size(v),I=0,J={left:"start",center:"middle",right:"end"},K={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeWidth:"stroke-width",strokeOpacity:"stroke-opacity",strokeCap:"stroke-linecap",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",opacity:"opacity"},L=E.keys(K);return z}(),E.headless.View=function(){var a=function(a,b,c,d,e,f){this._canvas=null,this._type=e,this._el="body",this._build=!1,this._model=new E.Model,this._width=this.__width=a||500,this._height=this.__height=b||500,this._bgcolor=d||null,this._padding=c||{top:0,left:0,bottom:0,right:0},this._autopad=E.isString(this._padding)?1:0,this._renderer=new E.headless[e],this._viewport=f||null,this.initialize()},b=a.prototype;return b.el=function(a){return arguments.length?(this._el!==a&&(this._el=a,this.initialize()),this):this._el},b.model=function(){return this._model},b.width=function(a){return arguments.length?(this._width!==a&&(this._width=a,this.initialize(),this._model.width(a)),this):this._width},b.height=function(a){return arguments.length?(this._height!==a&&(this._height=a,this.initialize(),this._model.height(this._height)),this):this._height},b.background=function(a){return arguments.length?(this._bgcolor!==a&&(this._bgcolor=a,this.initialize()),this):this._bgcolor},b.padding=function(a){return arguments.length?(this._padding!==a&&(E.isString(a)?(this._autopad=1,this._padding={top:0,left:0,bottom:0,right:0},this._strict="strict"===a):(this._autopad=0,this._padding=a,this._strict=!1),this.initialize()),this):this._padding},b.autopad=function(a){if(this._autopad<1)return this;this._autopad=0;var b=this._padding,c=this._model.scene().bounds,d=E.config.autopadInset,e=c.x1<0?Math.ceil(-c.x1)+d:0,f=c.y1<0?Math.ceil(-c.y1)+d:0,g=c.x2>this._width?Math.ceil(+c.x2-this._width)+d:0,c=c.y2>this._height?Math.ceil(+c.y2-this._height)+d:0;return b={left:e,top:f,right:g,bottom:c},this._strict?(this._autopad=0,this._padding=b,this._width=Math.max(0,this.__width-(e+g)),this._height=Math.max(0,this.__height-(f+c)),this._model.width(this._width),this._model.height(this._height),this._el&&this.initialize(),this.update({props:"enter"}).update({props:"update"})):this.padding(b).update(a),this},b.viewport=function(a){return arguments.length?(this._viewport=a,this.initialize(),this):_viewport},b.defs=function(a){return arguments.length?(this._model.defs(a),this):this._model.defs()},b.data=function(a){if(!arguments.length)return this._model.data();var b=E.keys(a).reduce(function(b,c){return b[c]=E.data.ingestAll(a[c]),b},{});return this._model.data(b),this._build=!1,this},b.renderer=function(){return this._renderer},b.canvas=function(){return this._canvas},b.canvasAsync=function(a){function b(){0===c.pendingImages()?(d.render(),a(d._canvas)):setTimeout(b,10)}var c=this._renderer,d=this;c.pendingImages()>0?b():a(this._canvas)},b.svg=function(){return"svg"===this._type?this._renderer.svg():null},b.initialize=function(){var a=this._width,b=this._height,c=this._bgcolor,d=this._padding;return this._viewport&&(a=this._viewport[0]-(d?d.left+d.right:0),b=this._viewport[1]-(d?d.top+d.bottom:0)),"svg"===this._type?this.initSVG(a,b,d,c):this.initCanvas(a,b,d,c),this},b.initCanvas=function(a,b,c,d){var e=require("canvas"),f=a+(c?c.left+c.right:0),g=b+(c?c.top+c.bottom:0),h=this._canvas=new e(f,g),i=h.getContext("2d");i.setTransform(1,0,0,1,c.left,c.top),this._renderer.context(i),this._renderer.resize(a,b,c),this._renderer.background(d)},b.initSVG=function(a,b,c,d){var e=a+(c?c.left+c.right:0),f=b+(c?c.top+c.bottom:0);this._renderer.initialize(this._el,e,f,c,d)},b.render=function(a){return this._renderer.render(this._model.scene(),a),this},b.update=function(a){a=a||{};var b=this;return b._build=b._build||(b._model.build(),!0),b._model.encode(null,a.props,a.items),b.render(a.items),b.autopad(a)},a}(),E.headless.View.Factory=function(a){return function(b){b=b||{};var c=a.width,d=a.height,e=a.padding,f=a.background,g=a.viewport,h=b.renderer||"canvas",i=new E.headless.View(c,d,e,f,h,g).defs(a);return a.data.load&&i.data(a.data.load),b.data&&i.data(b.data),i}},E.headless.render=function(a,b){function c(c){try{var d=c({data:a.data,renderer:a.renderer}).update();"svg"===a.renderer?b(null,{svg:d.svg(),view:d}):d.canvasAsync(function(a){b(null,{canvas:a,view:d})})}catch(e){b(e,null)}}E.parse.spec(a.spec,c,E.headless.View.Factory)},vegaColors(E),E}function vegaColors(a){a.config.range={shapes:["circle","cross","diamond","square","triangle-down","triangle-up"],category10:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],category20:["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],category20b:["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],category20c:["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"],hgdefault:["#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F"],parula:["#352A87","#363093","#3637A0","#353DAD","#3243BA","#2C4AC7","#2053D4","#0F5CDD","#0363E1","#0268E1","#046DE0","#0871DE","#0D75DC","#1079DA","#127DD8","#1481D6","#1485D4","#1389D3","#108ED2","#0C93D2","#0998D1","#079CCF","#06A0CD","#06A4CA","#06A7C6","#07A9C2","#0AACBE","#0FAEB9","#15B1B4","#1DB3AF","#25B5A9","#2EB7A4","#38B99E","#42BB98","#4DBC92","#59BD8C","#65BE86","#71BF80","#7CBF7B","#87BF77","#92BF73","#9CBF6F","#A5BE6B","#AEBE67","#B7BD64","#C0BC60","#C8BC5D","#D1BB59","#D9BA56","#E1B952","#E9B94E","#F1B94A","#F8BB44","#FDBE3D","#FFC337","#FEC832","#FCCE2E","#FAD32A","#F7D826","#F5DE21","#F5E41D","#F5EB18","#F6F313","#F9FB0E"],jet:["#00008F","#00009F","#0000AF","#0000BF","#0000CF","#0000DF","#0000EF","#0000FF","#0010FF","#0020FF","#0030FF","#0040FF","#0050FF","#0060FF","#0070FF","#0080FF","#008FFF","#009FFF","#00AFFF","#00BFFF","#00CFFF","#00DFFF","#00EFFF","#00FFFF","#10FFEF","#20FFDF","#30FFCF","#40FFBF","#50FFAF","#60FF9F","#70FF8F","#80FF80","#8FFF70","#9FFF60","#AFFF50","#BFFF40","#CFFF30","#DFFF20","#EFFF10","#FFFF00","#FFEF00","#FFDF00","#FFCF00","#FFBF00","#FFAF00","#FF9F00","#FF8F00","#FF8000","#FF7000","#FF6000","#FF5000","#FF4000","#FF3000","#FF2000","#FF1000","#FF0000","#EF0000","#DF0000","#CF0000","#BF0000","#AF0000","#9F0000","#8F0000","#800000"],hsv:["#FF0000","#FF1800","#FF3000","#FF4800","#FF6000","#FF7800","#FF8F00","#FFA700","#FFBF00","#FFD700","#FFEF00","#F7FF00","#DFFF00","#C7FF00","#AFFF00","#97FF00","#80FF00","#68FF00","#50FF00","#38FF00","#20FF00","#08FF00","#00FF10","#00FF28","#00FF40","#00FF58","#00FF70","#00FF87","#00FF9F","#00FFB7","#00FFCF","#00FFE7","#00FFFF","#00E7FF","#00CFFF","#00B7FF","#009FFF","#0087FF","#0070FF","#0058FF","#0040FF","#0028FF","#0010FF","#0800FF","#2000FF","#3800FF","#5000FF","#6800FF","#8000FF","#9700FF","#AF00FF","#C700FF","#DF00FF","#F700FF","#FF00EF","#FF00D7","#FF00BF","#FF00A7","#FF008F","#FF0078","#FF0060","#FF0048","#FF0030","#FF0018"],hot:["#0B0000","#150000","#200000","#2B0000","#350000","#400000","#4A0000","#550000","#600000","#6A0000","#750000","#800000","#8A0000","#950000","#9F0000","#AA0000","#B50000","#BF0000","#CA0000","#D50000","#DF0000","#EA0000","#F40000","#FF0000","#FF0B00","#FF1500","#FF2000","#FF2B00","#FF3500","#FF4000","#FF4A00","#FF5500","#FF6000","#FF6A00","#FF7500","#FF8000","#FF8A00","#FF9500","#FF9F00","#FFAA00","#FFB500","#FFBF00","#FFCA00","#FFD500","#FFDF00","#FFEA00","#FFF400","#FFFF00","#FFFF10","#FFFF20","#FFFF30","#FFFF40","#FFFF50","#FFFF60","#FFFF70","#FFFF80","#FFFF8F","#FFFF9F","#FFFFAF","#FFFFBF","#FFFFCF","#FFFFDF","#FFFFEF","#FFFFFF"],cool:["#00FFFF","#04FBFF","#08F7FF","#0CF3FF","#10EFFF","#14EBFF","#18E7FF","#1CE3FF","#20DFFF","#24DBFF","#28D7FF","#2DD2FF","#31CEFF","#35CAFF","#39C6FF","#3DC2FF","#41BEFF","#45BAFF","#49B6FF","#4DB2FF","#51AEFF","#55AAFF","#59A6FF","#5DA2FF","#619EFF","#659AFF","#6996FF","#6D92FF","#718EFF","#758AFF","#7986FF","#7D82FF","#827DFF","#8679FF","#8A75FF","#8E71FF","#926DFF","#9669FF","#9A65FF","#9E61FF","#A25DFF","#A659FF","#AA55FF","#AE51FF","#B24DFF","#B649FF","#BA45FF","#BE41FF","#C23DFF","#C639FF","#CA35FF","#CE31FF","#D22DFF","#D728FF","#DB24FF","#DF20FF","#E31CFF","#E718FF","#EB14FF","#EF10FF","#F30CFF","#F708FF","#FB04FF","#FF00FF"],spring:["#FF00FF","#FF04FB","#FF08F7","#FF0CF3","#FF10EF","#FF14EB","#FF18E7","#FF1CE3","#FF20DF","#FF24DB","#FF28D7","#FF2DD2","#FF31CE","#FF35CA","#FF39C6","#FF3DC2","#FF41BE","#FF45BA","#FF49B6","#FF4DB2","#FF51AE","#FF55AA","#FF59A6","#FF5DA2","#FF619E","#FF659A","#FF6996","#FF6D92","#FF718E","#FF758A","#FF7986","#FF7D82","#FF827D","#FF8679","#FF8A75","#FF8E71","#FF926D","#FF9669","#FF9A65","#FF9E61","#FFA25D","#FFA659","#FFAA55","#FFAE51","#FFB24D","#FFB649","#FFBA45","#FFBE41","#FFC23D","#FFC639","#FFCA35","#FFCE31","#FFD22D","#FFD728","#FFDB24","#FFDF20","#FFE31C","#FFE718","#FFEB14","#FFEF10","#FFF30C","#FFF708","#FFFB04","#FFFF00"],summer:["#008066","#048266","#088466","#0C8666","#108866","#148A66","#188C66","#1C8E66","#209066","#249266","#289466","#2D9666","#319866","#359A66","#399C66","#3D9E66","#41A066","#45A266","#49A466","#4DA666","#51A866","#55AA66","#59AC66","#5DAE66","#61B066","#65B266","#69B466","#6DB666","#71B866","#75BA66","#79BC66","#7DBE66","#82C066","#86C266","#8AC466","#8EC666","#92C866","#96CA66","#9ACC66","#9ECE66","#A2D066","#A6D266","#AAD466","#AED766","#B2D966","#B6DB66","#BADD66","#BEDF66","#C2E166","#C6E366","#CAE566","#CEE766","#D2E966","#D7EB66","#DBED66","#DFEF66","#E3F166","#E7F366","#EBF566","#EFF766","#F3F966","#F7FB66","#FBFD66","#FFFF66"],autumn:["#FF0000","#FF0400","#FF0800","#FF0C00","#FF1000","#FF1400","#FF1800","#FF1C00","#FF2000","#FF2400","#FF2800","#FF2D00","#FF3100","#FF3500","#FF3900","#FF3D00","#FF4100","#FF4500","#FF4900","#FF4D00","#FF5100","#FF5500","#FF5900","#FF5D00","#FF6100","#FF6500","#FF6900","#FF6D00","#FF7100","#FF7500","#FF7900","#FF7D00","#FF8200","#FF8600","#FF8A00","#FF8E00","#FF9200","#FF9600","#FF9A00","#FF9E00","#FFA200","#FFA600","#FFAA00","#FFAE00","#FFB200","#FFB600","#FFBA00","#FFBE00","#FFC200","#FFC600","#FFCA00","#FFCE00","#FFD200","#FFD700","#FFDB00","#FFDF00","#FFE300","#FFE700","#FFEB00","#FFEF00","#FFF300","#FFF700","#FFFB00","#FFFF00"],winter:["#0000FF","#0004FD","#0008FB","#000CF9","#0010F7","#0014F5","#0018F3","#001CF1","#0020EF","#0024ED","#0028EB","#002DE9","#0031E7","#0035E5","#0039E3","#003DE1","#0041DF","#0045DD","#0049DB","#004DD9","#0051D7","#0055D5","#0059D2","#005DD0","#0061CE","#0065CC","#0069CA","#006DC8","#0071C6","#0075C4","#0079C2","#007DC0","#0082BE","#0086BC","#008ABA","#008EB8","#0092B6","#0096B4","#009AB2","#009EB0","#00A2AE","#00A6AC","#00AAAA","#00AEA8","#00B2A6","#00B6A4","#00BAA2","#00BEA0","#00C29E","#00C69C","#00CA9A","#00CE98","#00D296","#00D794","#00DB92","#00DF90","#00E38E","#00E78C","#00EB8A","#00EF88","#00F386","#00F784","#00FB82","#00FF80"],gray:["#000000","#040404","#080808","#0C0C0C","#101010","#141414","#181818","#1C1C1C","#202020","#242424","#282828","#2D2D2D","#313131","#353535","#393939","#3D3D3D","#414141","#454545","#494949","#4D4D4D","#515151","#555555","#595959","#5D5D5D","#616161","#656565","#696969","#6D6D6D","#717171","#757575","#797979","#7D7D7D","#828282","#868686","#8A8A8A","#8E8E8E","#929292","#969696","#9A9A9A","#9E9E9E","#A2A2A2","#A6A6A6","#AAAAAA","#AEAEAE","#B2B2B2","#B6B6B6","#BABABA","#BEBEBE","#C2C2C2","#C6C6C6","#CACACA","#CECECE","#D2D2D2","#D7D7D7","#DBDBDB","#DFDFDF","#E3E3E3","#E7E7E7","#EBEBEB","#EFEFEF","#F3F3F3","#F7F7F7","#FBFBFB","#FFFFFF"],bone:["#000001","#040406","#07070B","#0B0B10","#0E0E15","#12121A","#15151F","#191923","#1C1C28","#20202D","#232332","#272737","#2B2B3C","#2E2E41","#323246","#35354A","#39394F","#3C3C54","#404059","#43435E","#474763","#4A4A68","#4E4E6C","#515171","#555675","#595B78","#5C607C","#606580","#636A83","#676F87","#6A748A","#6E788E","#717D91","#758295","#788798","#7C8C9C","#80919F","#8396A3","#879BA6","#8A9FAA","#8EA4AE","#91A9B1","#95AEB5","#98B3B8","#9CB8BC","#9FBDBF","#A3C1C3","#A6C6C6","#ACCACA","#B2CDCD","#B7D1D1","#BDD5D5","#C2D8D8","#C8DCDC","#CDDFDF","#D3E3E3","#D8E6E6","#DEEAEA","#E3EDED","#E9F1F1","#EEF4F4","#F4F8F8","#F9FBFB","#FFFFFF"],copper:["#000000","#050302","#0A0604","#0F0906","#140D08","#19100A","#1E130C","#23160E","#281910","#2E1C12","#332014","#382316","#3D2618","#42291A","#472C1C","#4C2F1E","#513320","#563622","#5B3924","#603C26","#653F28","#6A422A","#6F462C","#74492E","#794C30","#7E4F32","#845234","#895536","#8E5938","#935C3A","#985F3C","#9D623E","#A26540","#A76842","#AC6C44","#B16F46","#B67248","#BB754B","#C0784D","#C57B4F","#CA7E51","#CF8253","#D48555","#DA8857","#DF8B59","#E48E5B","#E9915D","#EE955F","#F39861","#F89B63","#FD9E65","#FFA167","#FFA469","#FFA86B","#FFAB6D","#FFAE6F","#FFB171","#FFB473","#FFB775","#FFBB77","#FFBE79","#FFC17B","#FFC47D","#FFC77F"],pink:["#1E0000","#321A1A","#402525","#4B2D2D","#553434","#5E3B3B","#664040","#6E4545","#754A4A","#7B4F4F","#825353","#885757","#8D5B5B","#935F5F","#986262","#9D6666","#A26969","#A76C6C","#AC6F6F","#B07272","#B57575","#B97878","#BD7B7B","#C27E7E","#C38481","#C58A83","#C79086","#C99588","#CA9A8B","#CC9F8D","#CEA490","#CFA992","#D1AE94","#D3B297","#D4B799","#D6BB9B","#D8BF9D","#D9C3A0","#DBC7A2","#DCCBA4","#DECFA6","#DFD3A8","#E1D7AA","#E2DAAC","#E4DEAE","#E5E1B0","#E7E5B2","#E8E8B4","#EAEAB9","#EBEBBF","#EDEDC4","#EEEEC9","#F0F0CE","#F1F1D3","#F3F3D8","#F4F4DD","#F5F5E1","#F7F7E6","#F8F8EA","#FAFAEE","#FBFBF3","#FCFCF7","#FEFEFB","#FFFFFF"],lines:["#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD"]}}var thingSpeakWebplot=function(a){function b(b,d,e){this.helperFunctions=new c,this.internalData={},this.view=null,this.emptySpec={width:425,height:340,scales:[{name:"x",type:"linear",range:"width",domainMin:0,domainMax:10},{name:"y",type:"linear",range:"height",domainMin:0,domainMax:10}],axes:[{type:"x",scale:"x"},{type:"y",scale:"y"}]},this.d3=b,this.topojson=d,this.$=e,this.setDomElement=function(a){if("object"==typeof a){var b=Date.now();a.setAttribute("id",b),a="#"+b}this.internalData.domId=a},this.setSpec=function(a,b){this.schemaCheck(a)||(this.helperFunctions.errorMessage("this json format is not supported"),a=this.emptySpec),this.VERSION=a.version;var c=this;if(b&&this.setDomElement(b),a&&(this.spec=a),this.setScales(a),this.$&&a.resizableButtonVisible!==!1){this.loadResizeLibraries();var d=this;setTimeout(function(){d.$(b).resizable&&d.$(b).resizable({stop:function(a,b){var d=c.getSpec();d.width=b.size.width,d.height=b.size.height,c.setSpec(d),c.render()}})},500)}this.marginY=this.spec.marginY||0,this.marginX=this.spec.marginX||0,this.width=this.spec.width=this.spec.width-this.marginX,this.height=this.spec.height=this.spec.height-this.marginY,this.renderer=this.spec.renderer||"svg"},this.schemaCheck=function(a){if(!(a&&a.data&&a.data.length>=1))return!1;for(var b=0;b<a.data.length;b++){if(!(a.data[b].url||a.data[b].source||a.data[b].values))return!1;if(a.data[b].values&&0===a.data[b].values.length)return!1}return!0},this.getSpec=function(){return this.spec},this.getInternalData=function(){return this.internalData},this.getTooltipClassName=function(){return this.tip.attr("class")},this.loadResizeLibraries=function(){var a=(this.getSpec(),document.createElement("script"));a.src="//code.jquery.com/ui/1.11.4/jquery-ui.min.js",document.getElementsByTagName("head")[0].appendChild(a);var b=document.createElement("link");return b.href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css",b.type="text/css",b.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(b),{script:a.src,style:b.href}},this.loadLibraries=function(b,c,d){this.getSpec();this.d3||(this.d3=b||a.d3||this.helperFunctions.errorMessage("d3.js is not found")),this.d3&&!this.topojson&&(this.topojson=c||a.topojson||this.helperFunctions.errorMessage("topojson.js is not found")),this.d3&&this.topojson&&!this.vg&&(this.vg=vegaFactory&&vegaFactory(this.d3,this.topojson)||this.helperFunctions.errorMessage("vega.js is not found")),this.$||(this.$=d||a.$||this.helperFunctions.errorMessage("jQuery is not found"))},this.render=function(a){var b=this.getSpec(),c=this.helperFunctions.proxyFn(this,this.parseSpec,a);this.vg.parse.spec(b,c)},this.parseSpec=function(a,b){var c=this.getSpec();null!=a?(this.view=a({el:this.internalData.domId,renderer:this.renderer}),this.view&&"svg"===this.renderer&&(this.viewUpdate(),this.svg=this.d3.select(this.internalData.domId+" svg"),c.tipEnabled!==!1&&(this.attachTip(),this.attachEvents()),c.interactivity!==!1&&(this.attachInteraction(),"time"===this.xScale&&c.hoverLineOn!==!1&&(this.createHoverLine(),this.createDateLabel())),b&&(c.resizable===!0&&this.resized||c.resizable===!1)&&b.call())):this.helperFunctions.errorMessage("vega rendering failed.")},this.forceSize=function(){var a=this.svg.attr("width"),b=this.svg.attr("height"),c=this.d3.select(this.internalData.domId+" rect"),d=this.getSpec();(a>this.width||b>this.height)&&(d.marginX=a-c.attr("width"),d.marginY=b-c.attr("height"),this.setSpec(d))},this.resize=function(){var a=this,b=this.getSpec();"svg"===this.renderer&&b.resizable&&(this.resizeIntervalFunction=setInterval(function(){a.view&&(a.forceSize(),a.render(),clearInterval(a.resizeIntervalFunction),a.resized=!0)},100))},this.viewUpdate=function(a){this.view&&(this.view.update(a),"svg"===this.renderer&&this.appendClip())},this.resetView=function(){this.render()},this.createZoomFunction=function(){var a=this,b=this.view.model().scene().items[0].scales;if(b){var c=this.d3.behavior.zoom().on("zoom",function(){a.view.update({props:"enter",legend:!1}),a.viewUpdate({props:"update",legend:!1}),a.tip&&a.tip.hide()}).x(b.x);return b.y&&(c=c.y(b.y)),c.scaleExtent([1,1/0]).center([this.width/2,this.height/2]).size([this.width,this.height])}},this.attachEvents=function(){var a=this.helperFunctions.proxyFn(this,this.onmouseevents);this.getSpec();this.view&&(this.view.on("mouseover",a),this.view.on("mouseout",a))},this.attachTip=function(){var a=this.getSpec();this.tip=this.d3.tip().attr("class",a&&a.tooltipClass||"tooltip").direction("e").offset([0,6]).html(a&&a.getTooltipContent||this.helperFunctions.getTooltipContent),this.svg.call(this.tip)},this.attachInteraction=function(){var a=this,b=this.createZoomFunction();this.svg.call(b),this.svg.on("dblclick.zoom",function(){a.resetView()}),this.setChartCursor("move")},this.createHoverLine=function(){var a=this;this.hoverLineGroup=this.svg.select("g").append("svg:g").attr("class","hover-line"),this.hoverLine=this.hoverLineGroup.append("svg:line").attr("x1",10).attr("x2",10).attr("y1",0).attr("y2",this.getSpec().height).classed("hide",!0),this.$(this.internalData.domId).on("mousemove",function(b){a.mouseDown&&(a.isPanning=!0);var c={x:b.pageX-a.hoverLineXOffset,y:b.pageY-a.hoverLineYOffset};a.handleGraphMouseIn(c)}).on("mouseenter",function(b){var c={x:b.pageX-a.hoverLineXOffset,y:b.pageY-a.hoverLineYOffset};a.handleGraphMouseIn(c)}).on("mousedown",function(b){a.mouseDown=!0}).on("mouseup",function(b){a.mouseDown=!1,a.isPanning=!1});var b=this.$(this.$(this.internalData.domId+" rect")[0]).offset();this.hoverLineXOffset=b.left,this.hoverLineYOffset=b.top},this.createDateLabel=function(){this.svg.select("g").append("svg:g").attr("class","date-label-group").append("svg:text").attr("class","date-label").attr("text-anchor","end").attr("font-size","10").attr("y",-4).attr("x",this.getSpec().width).text("")},this.setChartCursor=function(a){a&&this.svg.style("cursor",a)},this.onmouseevents=function(a,b){"mouseover"===a.type?(this.checkMarkType(b)&&this.tip&&this.tip.show(b.datum,this.xScale,this.yScale,b._svg),b.hasPropertySet("hover")&&this.viewUpdate({props:"hover",items:b})):(this.checkMarkType(b)&&this.tip&&this.tip.hide(),b.hasPropertySet("hover")&&this.viewUpdate({props:"update",items:b}))},this.handleGraphMouseIn=function(a){if(a){var b=a.x,c=a.y,d=this.getSpec(),e=this.view.model().scene().items[0].scales.x;b>0&&b<=d.width&&c>0&&c<=d.height?(this.updateDateTextContent(e.invert(b)),this.redrawHoverLine(b)):this.handleGraphMouseOut()}},this.handleGraphMouseOut=function(){this.clearDateTextContent(),this.hoverLine.classed("hide",!0)},this.redrawHoverLine=function(a){this.hoverLine.classed("hide",!1),this.hoverLine.attr("x1",a).attr("x2",a)},this.checkMarkType=function(a){return a&&a.mark&&a.mark.marktype?"symbol"===a.mark.marktype||"path"===a.mark.marktype||"rect"===a.mark.marktype:!1},this.appendClip=function(){var a;a=this.svg?this.svg:this.d3.select(this.internalData.domId+" svg"),a.append("defs").append("svg:clipPath").attr("id","clip").append("svg:rect").attr("id","clip-rect").attr("x","0").attr("y","0").attr("width",this.width).attr("height",this.height),a.selectAll(".type-viz-mark").attr("clip-path","url(#clip)")},this.setScales=function(a){if(a&&a.scales)for(var b=0;b<a.scales.length;b++)"x"===a.scales[b].name?this.xScale=a.scales[b].type:"y"===a.scales[b].name&&(this.yScale=a.scales[b].type)},this.updateDateTextContent=function(a,b){var c=this.getDateLabelNode(b);c&&a?this.isPanning||c.text(new Date(a)):this.helperFunctions.errorMessage("date label is not found.");
},this.clearDateTextContent=function(a){var b=this.getDateLabelNode(a);b?this.isPanning||b.text(""):this.helperFunctions.errorMessage("date label is not found.")},this.getDateLabelNode=function(a){var b=this.d3.select("text.date-label");return!b&&a&&(b=a),b}}var c=function(){this.errorMessage=function(a){console.log(a)},this.proxyFn=function(a,b,c){return function(){arguments=Array.prototype.slice.call(arguments),c&&(arguments=arguments.concat(c)),b.apply(a,arguments)}},this.getTooltipContent=function(a,b,c){function d(a){return d3.time.format("%a %b %e %Y")(a)+"<br/>"+d3.time.format("%I:%M:%S %p")(a)+"<br/>"+d3.time.format("GMT%Z")(a)}function e(a){return d3.format(",g")(a)}var f,g;return f="time"===b?d(new Date(a.data.x)):e("object"==typeof a.data?a.data.x:a.x),g="time"===c?d(new Date(a.data.y)):e("object"==typeof a.data?a.data.y:a.data),"<table><tr valign='top'><td>X:</td><td>"+f+"</td></tr><tr valign='top'><td>Y:</td><td>"+g+"</td></tr></table>"}};return"function"==typeof define&&define.amd?void define(["thingspeak_webplot/d3.min","thingspeak_webplot/topojson.min"],function(a,c){return function(){return new b(a,c)}}):b}(this);